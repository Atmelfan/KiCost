Variables:
BoardQty = 'complex_multipart'!$M$1
PURCHASE_DESCRIPTION = 'complex_multipart'!$M$12
TotalCost = 'complex_multipart'!$M$3
USD_EUR = 'complex_multipart'!$C$12
arrow_part_data = 'complex_multipart'!$N$5:$R$9
digikey_part_data = 'complex_multipart'!$S$5:$W$9
farnell_part_data = 'complex_multipart'!$X$5:$AB$9
global_part_data = 'complex_multipart'!$A$5:$M$9
lcsc_part_data = 'complex_multipart'!$AC$5:$AG$9
mouser_part_data = 'complex_multipart'!$AH$5:$AL$9
newark_part_data = 'complex_multipart'!$AM$5:$AQ$9
rs_part_data = 'complex_multipart'!$AR$5:$AV$9
tme_part_data = 'complex_multipart'!$AW$5:$BA$9
we_part_data = 'complex_multipart'!$BB$5:$BF$9
--------------------------------------------------------------------------------
Row: 1
 Col: A
   "Prj:"
 Col: B
   "Complex multipart"
 Col: L
   "Board Qty:"
 Col: M
   100
Row: 2
 Col: A
   "Co.:"
 Col: B
   "KiCOST TEST"
 Col: L
   "Unit Cost:"
 Col: M
   0
  Formula: TotalCost/BoardQty
Row: 3
 Col: A
   "Prj date:"
 Col: B
   "2021-01-02"
 Col: L
   "Total Cost:"
 Col: M
   0
  Formula: SUM(M7:M9)
 Col: Q
   0
  Formula: SUM(Q7:Q9)
 Col: R
   0
  Formula: (COUNTA(Q7:Q9)&" of "&ROWS(Q7:Q9)&" parts found")
 Col: V
   0
  Formula: SUM(V7:V9)
 Col: W
   0
  Formula: (COUNTA(V7:V9)&" of "&ROWS(V7:V9)&" parts found")
 Col: AA
   0
  Formula: SUM(AA7:AA9)
 Col: AB
   0
  Formula: (COUNTA(AA7:AA9)&" of "&ROWS(AA7:AA9)&" parts found")
 Col: AF
   0
  Formula: SUM(AF7:AF9)
 Col: AG
   0
  Formula: (COUNTA(AF7:AF9)&" of "&ROWS(AF7:AF9)&" parts found")
 Col: AK
   0
  Formula: SUM(AK7:AK9)
 Col: AL
   0
  Formula: (COUNTA(AK7:AK9)&" of "&ROWS(AK7:AK9)&" parts found")
 Col: AP
   0
  Formula: SUM(AP7:AP9)
 Col: AQ
   0
  Formula: (COUNTA(AP7:AP9)&" of "&ROWS(AP7:AP9)&" parts found")
 Col: AU
   0
  Formula: SUM(AU7:AU9)
 Col: AV
   0
  Formula: (COUNTA(AU7:AU9)&" of "&ROWS(AU7:AU9)&" parts found")
 Col: AZ
   0
  Formula: SUM(AZ7:AZ9)
 Col: BA
   0
  Formula: (COUNTA(AZ7:AZ9)&" of "&ROWS(AZ7:AZ9)&" parts found")
 Col: BE
   0
  Formula: SUM(BE7:BE9)
 Col: BF
   0
  Formula: (COUNTA(BE7:BE9)&" of "&ROWS(BE7:BE9)&" parts found")
Row: 4
 Col: A
   "$ date:"
 Col: B
   *FILTERED*
Row: 5
 Col: A
   "Global Part Info"
 Col: N
   "Arrow"
 Col: S
   "Digi-Key"
 Col: X
   "Farnell"
 Col: AC
   "LCSC"
 Col: AH
   "Mouser"
 Col: AM
   "Newark"
 Col: AR
   "RS Components"
 Col: AW
   "TME"
 Col: BB
   "we"
Row: 6
 Col: A
   "Refs"
 Col: B
   "Value"
 Col: C
   "Desc"
 Col: D
   "S1MN"
 Col: E
   "S1PN"
 Col: F
   "S2MN"
 Col: G
   "S2PN"
 Col: H
   "Footprint"
 Col: I
   "Manf"
 Col: J
   "Manf#"
 Col: K
   "Qty"
 Col: L
   "Unit$"
 Col: M
   "Ext$"
 Col: N
   "Avail"
 Col: O
   "Purch"
 Col: P
   "Unit$"
 Col: Q
   "Ext$"
 Col: R
   "Cat#"
 Col: S
   "Avail"
 Col: T
   "Purch"
 Col: U
   "Unit$"
 Col: V
   "Ext$"
 Col: W
   "Cat#"
 Col: X
   "Avail"
 Col: Y
   "Purch"
 Col: Z
   "Unit$"
 Col: AA
   "Ext$"
 Col: AB
   "Cat#"
 Col: AC
   "Avail"
 Col: AD
   "Purch"
 Col: AE
   "Unit$"
 Col: AF
   "Ext$"
 Col: AG
   "Cat#"
 Col: AH
   "Avail"
 Col: AI
   "Purch"
 Col: AJ
   "Unit$"
 Col: AK
   "Ext$"
 Col: AL
   "Cat#"
 Col: AM
   "Avail"
 Col: AN
   "Purch"
 Col: AO
   "Unit$"
 Col: AP
   "Ext$"
 Col: AQ
   "Cat#"
 Col: AR
   "Avail"
 Col: AS
   "Purch"
 Col: AT
   "Unit$"
 Col: AU
   "Ext$"
 Col: AV
   "Cat#"
 Col: AW
   "Avail"
 Col: AX
   "Purch"
 Col: AY
   "Unit$"
 Col: AZ
   "Ext$"
 Col: BA
   "Cat#"
 Col: BB
   "Avail"
 Col: BC
   "Purch"
 Col: BD
   "Unit$"
 Col: BE
   "Ext$"
 Col: BF
   "Cat#"
Row: 7
 Col: A
   "F1#1"
 Col: B
   "F-6A/250V - p1/3"
 Col: C
   "FUSE HOLDER for fuse 5mm x 20mm"
 Col: D
   "Eaton"
 Col: E
   "BK-1A3399-10-R:2"
 Col: F
   "Bussman"
 Col: G
   "1A3399-10-R:2"
 Col: I
   "Wurth Electronik"
 Col: J
   <a href="http://datasheet.octopart.com/696101000002-W%C3%BCrth-Elektronik-datasheet-117282884.pdf">696101000002</a>
 Col: K
   100
  Formula: CEILING(BoardQty*1.0,1)
 Col: L
   0
  Formula: MINA(P7,U7,Z7,AE7,AJ7,AO7,AT7,AY7,BD7)
 Col: M
   0
  Formula: iferror(K7*L7,"")
 Col: AH
   767
 Col: AJ
   0
  Formula: iferror(lookup(if(AI7="",K7,AI7),{0,1,10,50,100,1000,10000},{0.0,0.66,0.627,0.595,0.531,0.382,0.382}),"")
 Col: AK
   0
  Formula: iferror(if(AI7="",K7,AI7)*AJ7,"")
 Col: AL
   <a href="https://octopart.com/click/track?ai=8078&sig=0247e72&sid=2401&ppid=56808803&vpid=490212795&ct=offers">710696101000002</a>
 Col: BB
   "NonStk"
 Col: BD
   0
  Formula: iferror(USD_EUR*lookup(if(BC7="",K7,BC7),{0,1},{0.0,0.07}),"")
 Col: BE
   0
  Formula: iferror(if(BC7="",K7,BC7)*BD7,"")
 Col: BF
   "696101000002"
Row: 8
 Col: A
   "F1#2"
 Col: B
   "F-6A/250V - p2/3"
 Col: C
   "FUSE HOLDER for fuse 5mm x 20mm"
 Col: D
   "*NONE*"
 Col: E
   "*NONE*"
 Col: F
   "*NONE*"
 Col: G
   "*NONE*"
 Col: I
   "Bel Fuse"
 Col: J
   <a href="http://datasheet.octopart.com/5MF6-R-Bel-Fuse-datasheet-137317049.pdf">5MF 6-R</a>
 Col: K
   100
  Formula: CEILING(BoardQty*1.0,1)
 Col: L
   0
  Formula: MINA(P8,U8,Z8,AE8,AJ8,AO8,AT8,AY8,BD8)
 Col: M
   0
  Formula: iferror(K8*L8,"")
 Col: AH
   7857
 Col: AJ
   0
  Formula: iferror(lookup(if(AI8="",K8,AI8),{0,1,10,50,100,1000,10000},{0.0,0.22,0.205,0.19,0.171,0.12,0.095}),"")
 Col: AK
   0
  Formula: iferror(if(AI8="",K8,AI8)*AJ8,"")
 Col: AL
   <a href="https://octopart.com/click/track?ai=8078&sig=04c4592&sid=2401&ppid=55819047&vpid=217143194&ct=offers">5305MF6R</a>
 Col: BB
   "NonStk"
 Col: BD
   0
  Formula: iferror(lookup(if(BC8="",K8,BC8),{0},{0.0}),"")
 Col: BE
   0
  Formula: iferror(if(BC8="",K8,BC8)*BD8,"")
 Col: BF
   "5MF 6-R"
Row: 9
 Col: A
   "F1#3"
 Col: B
   "F-6A/250V - p3/3"
 Col: C
   "FUSE HOLDER for fuse 5mm x 20mm"
 Col: D
   "Cover clip?"
 Col: E
   "Cover clip?"
 Col: F
   "Cover clip?"
 Col: G
   "Cover clip?"
 Col: I
   "Wurth Electronik"
 Col: J
   "695120004001"
 Col: K
   100
  Formula: CEILING(BoardQty*1.0,1)
 Col: L
   0
  Formula: MINA(P9,U9,Z9,AE9,AJ9,AO9,AT9,AY9,BD9)
 Col: M
   0
  Formula: iferror(K9*L9,"")
 Col: BB
   "NonStk"
 Col: BD
   0
  Formula: iferror(USD_EUR*lookup(if(BC9="",K9,BC9),{0,1,100},{0.0,0.03,0.01}),"")
 Col: BE
   0
  Formula: iferror(if(BC9="",K9,BC9)*BD9,"")
 Col: BF
   "695120004001"
Row: 11
 Col: B1
   "Used currency rates:"
 Col: L1
   "Total Purchase:"
 Col: M1
   0
  Formula: SUM(Q11,V11,AA11,AF11,AK11,AP11,AU11,AZ11,BE11)
 Col: N1
   <a href="https://www.arrow.com/en/bom-tool/">Buy here</a>
 Col: O1
   0
  Formula: IFERROR(IF(OR(O7:O9),COUNTIFS(O7:O9,">0",Q7:Q9,"<>")&" of "&(ROWS(Q7:Q9)-COUNTBLANK(Q7:Q9))&" parts purchased",""),"")
 Col: Q1
   0
  Formula: SUMIF(O7:O9,">0",Q7:Q9)
 Col: S1
   <a href="https://www.digikey.com/ordering/shoppingcart">Buy here</a>
 Col: T1
   0
  Formula: IFERROR(IF(OR(T7:T9),COUNTIFS(T7:T9,">0",V7:V9,"<>")&" of "&(ROWS(V7:V9)-COUNTBLANK(V7:V9))&" parts purchased",""),"")
 Col: V1
   0
  Formula: SUMIF(T7:T9,">0",V7:V9)
 Col: X1
   <a href="https://fr.farnell.com/en-FR/quick-order?isQuickPaste=true">Buy here</a>
 Col: Y1
   0
  Formula: IFERROR(IF(OR(Y7:Y9),COUNTIFS(Y7:Y9,">0",AA7:AA9,"<>")&" of "&(ROWS(AA7:AA9)-COUNTBLANK(AA7:AA9))&" parts purchased",""),"")
 Col: AA1
   0
  Formula: SUMIF(Y7:Y9,">0",AA7:AA9)
 Col: AC1
   <a href="https://lcsc.com/bom.html">Buy here</a>
 Col: AD1
   0
  Formula: IFERROR(IF(OR(AD7:AD9),COUNTIFS(AD7:AD9,">0",AF7:AF9,"<>")&" of "&(ROWS(AF7:AF9)-COUNTBLANK(AF7:AF9))&" parts purchased",""),"")
 Col: AF1
   0
  Formula: SUMIF(AD7:AD9,">0",AF7:AF9)
 Col: AH1
   <a href="https://mouser.com/bom/">Buy here</a>
 Col: AI1
   0
  Formula: IFERROR(IF(OR(AI7:AI9),COUNTIFS(AI7:AI9,">0",AK7:AK9,"<>")&" of "&(ROWS(AK7:AK9)-COUNTBLANK(AK7:AK9))&" parts purchased",""),"")
 Col: AK1
   0
  Formula: SUMIF(AI7:AI9,">0",AK7:AK9)
 Col: AM1
   <a href="https://www.newark.com/quick-order?isQuickPaste=true">Buy here</a>
 Col: AN1
   0
  Formula: IFERROR(IF(OR(AN7:AN9),COUNTIFS(AN7:AN9,">0",AP7:AP9,"<>")&" of "&(ROWS(AP7:AP9)-COUNTBLANK(AP7:AP9))&" parts purchased",""),"")
 Col: AP1
   0
  Formula: SUMIF(AN7:AN9,">0",AP7:AP9)
 Col: AR1
   <a href="https://uk.rs-online.com/web/mylists/manualQuotes.html?method=showEnquiryCreationPage&mode=new">Buy here</a>
 Col: AS1
   0
  Formula: IFERROR(IF(OR(AS7:AS9),COUNTIFS(AS7:AS9,">0",AU7:AU9,"<>")&" of "&(ROWS(AU7:AU9)-COUNTBLANK(AU7:AU9))&" parts purchased",""),"")
 Col: AU1
   0
  Formula: SUMIF(AS7:AS9,">0",AU7:AU9)
 Col: AW1
   <a href="https://www.tme.eu/en/Profile/QuickBuy/load.html">Buy here</a>
 Col: AX1
   0
  Formula: IFERROR(IF(OR(AX7:AX9),COUNTIFS(AX7:AX9,">0",AZ7:AZ9,"<>")&" of "&(ROWS(AZ7:AZ9)-COUNTBLANK(AZ7:AZ9))&" parts purchased",""),"")
 Col: AZ1
   0
  Formula: SUMIF(AX7:AX9,">0",AZ7:AZ9)
 Col: BC1
   0
  Formula: IFERROR(IF(OR(BC7:BC9),COUNTIFS(BC7:BC9,">0",BE7:BE9,"<>")&" of "&(ROWS(BE7:BE9)-COUNTBLANK(BE7:BE9))&" parts purchased",""),"")
 Col: BE1
   0
  Formula: SUMIF(BC7:BC9,">0",BE7:BE9)
Row: 12
 Col: B1
   "USD($)/EUR(â‚¬):"
 Col: C1
   1.1873
 Col: L1
   "Purchase description:"
 Col: O1
   0
  Formula: IFERROR(CONCATENATE(INDEX(R7:R9,SMALL(IF(ISNUMBER(O7:O9),IF(O7:O9>0,IF(R7:R9<>"",ROW(O7:O9)-MIN(ROW(O7:O9))+1))),ROW()-ROW(A$12)+1)),",",TEXT(INDEX(O7:O9,SMALL(IF(ISNUMBER(O7:O9),IF(O7:O9>0,IF(R7:R9<>"",ROW(O7:O9)-MIN(ROW(O7:O9))+1))),ROW()-ROW(A$12)+1)),"##0"),",",SUBSTITUTE(INDEX(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&A7:A9,SMALL(IF(ISNUMBER(O7:O9),IF(O7:O9>0,IF(R7:R9<>"",ROW(O7:O9)-MIN(ROW(O7:O9))+1))),ROW()-ROW(A$12)+1)),",",";")),"")
 Col: T1
   0
  Formula: IFERROR(CONCATENATE(TEXT(INDEX(T7:T9,SMALL(IF(ISNUMBER(T7:T9),IF(T7:T9>0,IF(W7:W9<>"",ROW(T7:T9)-MIN(ROW(T7:T9))+1))),ROW()-ROW(A$12)+1)),"##0"),",",INDEX(W7:W9,SMALL(IF(ISNUMBER(T7:T9),IF(T7:T9>0,IF(W7:W9<>"",ROW(T7:T9)-MIN(ROW(T7:T9))+1))),ROW()-ROW(A$12)+1)),",",SUBSTITUTE(INDEX(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&A7:A9,SMALL(IF(ISNUMBER(T7:T9),IF(T7:T9>0,IF(W7:W9<>"",ROW(T7:T9)-MIN(ROW(T7:T9))+1))),ROW()-ROW(A$12)+1)),",",";")),"")
 Col: Y1
   0
  Formula: IFERROR(CONCATENATE(INDEX(AB7:AB9,SMALL(IF(ISNUMBER(Y7:Y9),IF(Y7:Y9>0,IF(AB7:AB9<>"",ROW(Y7:Y9)-MIN(ROW(Y7:Y9))+1))),ROW()-ROW(A$12)+1)),",",TEXT(INDEX(Y7:Y9,SMALL(IF(ISNUMBER(Y7:Y9),IF(Y7:Y9>0,IF(AB7:AB9<>"",ROW(Y7:Y9)-MIN(ROW(Y7:Y9))+1))),ROW()-ROW(A$12)+1)),"##0"),",",LEFT(SUBSTITUTE(SUBSTITUTE(INDEX(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&C7:C9,SMALL(IF(ISNUMBER(Y7:Y9),IF(Y7:Y9>0,IF(AB7:AB9<>"",ROW(Y7:Y9)-MIN(ROW(Y7:Y9))+1))),ROW()-ROW(A$12)+1)),",",";"),"\n",";"),30),",",LEFT(SUBSTITUTE(SUBSTITUTE(INDEX(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&A7:A9,SMALL(IF(ISNUMBER(Y7:Y9),IF(Y7:Y9>0,IF(AB7:AB9<>"",ROW(Y7:Y9)-MIN(ROW(Y7:Y9))+1))),ROW()-ROW(A$12)+1)),",",";"),"\n",";"),30)),"")
 Col: AD1
   0
  Formula: IFERROR(IF(COUNTIFS(AD7:AD9,">0",AF7:AF9,"<>")>0,"Quantity,Comment,Designator,Footprint,LCSC Part #(optional)",""),"")
 Col: AI1
   0
  Formula: IFERROR(CONCATENATE(INDEX(AL7:AL9,SMALL(IF(ISNUMBER(AI7:AI9),IF(AI7:AI9>0,IF(AL7:AL9<>"",ROW(AI7:AI9)-MIN(ROW(AI7:AI9))+1))),ROW()-ROW(A$12)+1)),"|",TEXT(INDEX(AI7:AI9,SMALL(IF(ISNUMBER(AI7:AI9),IF(AI7:AI9>0,IF(AL7:AL9<>"",ROW(AI7:AI9)-MIN(ROW(AI7:AI9))+1))),ROW()-ROW(A$12)+1)),"##0"),"|",SUBSTITUTE(SUBSTITUTE(INDEX(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&A7:A9,SMALL(IF(ISNUMBER(AI7:AI9),IF(AI7:AI9>0,IF(AL7:AL9<>"",ROW(AI7:AI9)-MIN(ROW(AI7:AI9))+1))),ROW()-ROW(A$12)+1)),"|",";")," ","_")),"")
 Col: AN1
   0
  Formula: IFERROR(CONCATENATE(INDEX(AQ7:AQ9,SMALL(IF(ISNUMBER(AN7:AN9),IF(AN7:AN9>0,IF(AQ7:AQ9<>"",ROW(AN7:AN9)-MIN(ROW(AN7:AN9))+1))),ROW()-ROW(A$12)+1)),",",TEXT(INDEX(AN7:AN9,SMALL(IF(ISNUMBER(AN7:AN9),IF(AN7:AN9>0,IF(AQ7:AQ9<>"",ROW(AN7:AN9)-MIN(ROW(AN7:AN9))+1))),ROW()-ROW(A$12)+1)),"##0"),",",SUBSTITUTE(SUBSTITUTE(INDEX(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&A7:A9,SMALL(IF(ISNUMBER(AN7:AN9),IF(AN7:AN9>0,IF(AQ7:AQ9<>"",ROW(AN7:AN9)-MIN(ROW(AN7:AN9))+1))),ROW()-ROW(A$12)+1)),",",";"),"\n",";"),",",SUBSTITUTE(SUBSTITUTE(INDEX(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&C7:C9,SMALL(IF(ISNUMBER(AN7:AN9),IF(AN7:AN9>0,IF(AQ7:AQ9<>"",ROW(AN7:AN9)-MIN(ROW(AN7:AN9))+1))),ROW()-ROW(A$12)+1)),",",";"),"\n",";")),"")
 Col: AS1
   0
  Formula: IFERROR(CONCATENATE(INDEX(AV7:AV9,SMALL(IF(ISNUMBER(AS7:AS9),IF(AS7:AS9>0,IF(AV7:AV9<>"",ROW(AS7:AS9)-MIN(ROW(AS7:AS9))+1))),ROW()-ROW(A$12)+1)),",",TEXT(INDEX(AS7:AS9,SMALL(IF(ISNUMBER(AS7:AS9),IF(AS7:AS9>0,IF(AV7:AV9<>"",ROW(AS7:AS9)-MIN(ROW(AS7:AS9))+1))),ROW()-ROW(A$12)+1)),"##0"),",",,",",,",",,",",INDEX(J7:J9,SMALL(IF(ISNUMBER(AS7:AS9),IF(AS7:AS9>0,IF(AV7:AV9<>"",ROW(AS7:AS9)-MIN(ROW(AS7:AS9))+1))),ROW()-ROW(A$12)+1)),",",SUBSTITUTE(INDEX(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&A7:A9,SMALL(IF(ISNUMBER(AS7:AS9),IF(AS7:AS9>0,IF(AV7:AV9<>"",ROW(AS7:AS9)-MIN(ROW(AS7:AS9))+1))),ROW()-ROW(A$12)+1)),",",";")),"")
 Col: AX1
   0
  Formula: IFERROR(CONCATENATE(INDEX(BA7:BA9,SMALL(IF(ISNUMBER(AX7:AX9),IF(AX7:AX9>0,IF(BA7:BA9<>"",ROW(AX7:AX9)-MIN(ROW(AX7:AX9))+1))),ROW()-ROW(A$12)+1))," ",TEXT(INDEX(AX7:AX9,SMALL(IF(ISNUMBER(AX7:AX9),IF(AX7:AX9>0,IF(BA7:BA9<>"",ROW(AX7:AX9)-MIN(ROW(AX7:AX9))+1))),ROW()-ROW(A$12)+1)),"##0")," ",SUBSTITUTE(INDEX(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&A7:A9,SMALL(IF(ISNUMBER(AX7:AX9),IF(AX7:AX9>0,IF(BA7:BA9<>"",ROW(AX7:AX9)-MIN(ROW(AX7:AX9))+1))),ROW()-ROW(A$12)+1))," ",";")),"")
 Col: BC1
   0
  Formula: IFERROR(CONCATENATE(INDEX(BF7:BF9,SMALL(IF(ISNUMBER(BC7:BC9),IF(BC7:BC9>0,IF(BF7:BF9<>"",ROW(BC7:BC9)-MIN(ROW(BC7:BC9))+1))),ROW()-ROW(A$12)+1)),",",TEXT(INDEX(BC7:BC9,SMALL(IF(ISNUMBER(BC7:BC9),IF(BC7:BC9>0,IF(BF7:BF9<>"",ROW(BC7:BC9)-MIN(ROW(BC7:BC9))+1))),ROW()-ROW(A$12)+1)),"##0"),",",SUBSTITUTE(INDEX(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&A7:A9,SMALL(IF(ISNUMBER(BC7:BC9),IF(BC7:BC9>0,IF(BF7:BF9<>"",ROW(BC7:BC9)-MIN(ROW(BC7:BC9))+1))),ROW()-ROW(A$12)+1)),",",";")),"")
Row: 13
 Col: O1
   0
  Formula: IFERROR(CONCATENATE(INDEX(R7:R9,SMALL(IF(ISNUMBER(O7:O9),IF(O7:O9>0,IF(R7:R9<>"",ROW(O7:O9)-MIN(ROW(O7:O9))+1))),ROW()-ROW(A$12)+1)),",",TEXT(INDEX(O7:O9,SMALL(IF(ISNUMBER(O7:O9),IF(O7:O9>0,IF(R7:R9<>"",ROW(O7:O9)-MIN(ROW(O7:O9))+1))),ROW()-ROW(A$12)+1)),"##0"),",",SUBSTITUTE(INDEX(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&A7:A9,SMALL(IF(ISNUMBER(O7:O9),IF(O7:O9>0,IF(R7:R9<>"",ROW(O7:O9)-MIN(ROW(O7:O9))+1))),ROW()-ROW(A$12)+1)),",",";")),"")
 Col: T1
   0
  Formula: IFERROR(CONCATENATE(TEXT(INDEX(T7:T9,SMALL(IF(ISNUMBER(T7:T9),IF(T7:T9>0,IF(W7:W9<>"",ROW(T7:T9)-MIN(ROW(T7:T9))+1))),ROW()-ROW(A$12)+1)),"##0"),",",INDEX(W7:W9,SMALL(IF(ISNUMBER(T7:T9),IF(T7:T9>0,IF(W7:W9<>"",ROW(T7:T9)-MIN(ROW(T7:T9))+1))),ROW()-ROW(A$12)+1)),",",SUBSTITUTE(INDEX(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&A7:A9,SMALL(IF(ISNUMBER(T7:T9),IF(T7:T9>0,IF(W7:W9<>"",ROW(T7:T9)-MIN(ROW(T7:T9))+1))),ROW()-ROW(A$12)+1)),",",";")),"")
 Col: Y1
   0
  Formula: IFERROR(CONCATENATE(INDEX(AB7:AB9,SMALL(IF(ISNUMBER(Y7:Y9),IF(Y7:Y9>0,IF(AB7:AB9<>"",ROW(Y7:Y9)-MIN(ROW(Y7:Y9))+1))),ROW()-ROW(A$12)+1)),",",TEXT(INDEX(Y7:Y9,SMALL(IF(ISNUMBER(Y7:Y9),IF(Y7:Y9>0,IF(AB7:AB9<>"",ROW(Y7:Y9)-MIN(ROW(Y7:Y9))+1))),ROW()-ROW(A$12)+1)),"##0"),",",LEFT(SUBSTITUTE(SUBSTITUTE(INDEX(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&C7:C9,SMALL(IF(ISNUMBER(Y7:Y9),IF(Y7:Y9>0,IF(AB7:AB9<>"",ROW(Y7:Y9)-MIN(ROW(Y7:Y9))+1))),ROW()-ROW(A$12)+1)),",",";"),"\n",";"),30),",",LEFT(SUBSTITUTE(SUBSTITUTE(INDEX(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&A7:A9,SMALL(IF(ISNUMBER(Y7:Y9),IF(Y7:Y9>0,IF(AB7:AB9<>"",ROW(Y7:Y9)-MIN(ROW(Y7:Y9))+1))),ROW()-ROW(A$12)+1)),",",";"),"\n",";"),30)),"")
 Col: AD1
   0
  Formula: IFERROR(CONCATENATE(TEXT(INDEX(AD7:AD9,SMALL(IF(ISNUMBER(AD7:AD9),IF(AD7:AD9>0,IF(AG7:AG9<>"",ROW(AD7:AD9)-MIN(ROW(AD7:AD9))+1))),ROW()-ROW(A$13)+1)),"##0"),",",SUBSTITUTE(INDEX(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&A7:A9,SMALL(IF(ISNUMBER(AD7:AD9),IF(AD7:AD9>0,IF(AG7:AG9<>"",ROW(AD7:AD9)-MIN(ROW(AD7:AD9))+1))),ROW()-ROW(A$13)+1)),",",";"),",",SUBSTITUTE(INDEX(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&H7:H9,SMALL(IF(ISNUMBER(AD7:AD9),IF(AD7:AD9>0,IF(AG7:AG9<>"",ROW(AD7:AD9)-MIN(ROW(AD7:AD9))+1))),ROW()-ROW(A$13)+1)),",",";"),",",INDEX(AG7:AG9,SMALL(IF(ISNUMBER(AD7:AD9),IF(AD7:AD9>0,IF(AG7:AG9<>"",ROW(AD7:AD9)-MIN(ROW(AD7:AD9))+1))),ROW()-ROW(A$13)+1))),"")
 Col: AI1
   0
  Formula: IFERROR(CONCATENATE(INDEX(AL7:AL9,SMALL(IF(ISNUMBER(AI7:AI9),IF(AI7:AI9>0,IF(AL7:AL9<>"",ROW(AI7:AI9)-MIN(ROW(AI7:AI9))+1))),ROW()-ROW(A$12)+1)),"|",TEXT(INDEX(AI7:AI9,SMALL(IF(ISNUMBER(AI7:AI9),IF(AI7:AI9>0,IF(AL7:AL9<>"",ROW(AI7:AI9)-MIN(ROW(AI7:AI9))+1))),ROW()-ROW(A$12)+1)),"##0"),"|",SUBSTITUTE(SUBSTITUTE(INDEX(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&A7:A9,SMALL(IF(ISNUMBER(AI7:AI9),IF(AI7:AI9>0,IF(AL7:AL9<>"",ROW(AI7:AI9)-MIN(ROW(AI7:AI9))+1))),ROW()-ROW(A$12)+1)),"|",";")," ","_")),"")
 Col: AN1
   0
  Formula: IFERROR(CONCATENATE(INDEX(AQ7:AQ9,SMALL(IF(ISNUMBER(AN7:AN9),IF(AN7:AN9>0,IF(AQ7:AQ9<>"",ROW(AN7:AN9)-MIN(ROW(AN7:AN9))+1))),ROW()-ROW(A$12)+1)),",",TEXT(INDEX(AN7:AN9,SMALL(IF(ISNUMBER(AN7:AN9),IF(AN7:AN9>0,IF(AQ7:AQ9<>"",ROW(AN7:AN9)-MIN(ROW(AN7:AN9))+1))),ROW()-ROW(A$12)+1)),"##0"),",",SUBSTITUTE(SUBSTITUTE(INDEX(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&A7:A9,SMALL(IF(ISNUMBER(AN7:AN9),IF(AN7:AN9>0,IF(AQ7:AQ9<>"",ROW(AN7:AN9)-MIN(ROW(AN7:AN9))+1))),ROW()-ROW(A$12)+1)),",",";"),"\n",";"),",",SUBSTITUTE(SUBSTITUTE(INDEX(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&C7:C9,SMALL(IF(ISNUMBER(AN7:AN9),IF(AN7:AN9>0,IF(AQ7:AQ9<>"",ROW(AN7:AN9)-MIN(ROW(AN7:AN9))+1))),ROW()-ROW(A$12)+1)),",",";"),"\n",";")),"")
 Col: AS1
   0
  Formula: IFERROR(CONCATENATE(INDEX(AV7:AV9,SMALL(IF(ISNUMBER(AS7:AS9),IF(AS7:AS9>0,IF(AV7:AV9<>"",ROW(AS7:AS9)-MIN(ROW(AS7:AS9))+1))),ROW()-ROW(A$12)+1)),",",TEXT(INDEX(AS7:AS9,SMALL(IF(ISNUMBER(AS7:AS9),IF(AS7:AS9>0,IF(AV7:AV9<>"",ROW(AS7:AS9)-MIN(ROW(AS7:AS9))+1))),ROW()-ROW(A$12)+1)),"##0"),",",,",",,",",,",",INDEX(J7:J9,SMALL(IF(ISNUMBER(AS7:AS9),IF(AS7:AS9>0,IF(AV7:AV9<>"",ROW(AS7:AS9)-MIN(ROW(AS7:AS9))+1))),ROW()-ROW(A$12)+1)),",",SUBSTITUTE(INDEX(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&A7:A9,SMALL(IF(ISNUMBER(AS7:AS9),IF(AS7:AS9>0,IF(AV7:AV9<>"",ROW(AS7:AS9)-MIN(ROW(AS7:AS9))+1))),ROW()-ROW(A$12)+1)),",",";")),"")
 Col: AX1
   0
  Formula: IFERROR(CONCATENATE(INDEX(BA7:BA9,SMALL(IF(ISNUMBER(AX7:AX9),IF(AX7:AX9>0,IF(BA7:BA9<>"",ROW(AX7:AX9)-MIN(ROW(AX7:AX9))+1))),ROW()-ROW(A$12)+1))," ",TEXT(INDEX(AX7:AX9,SMALL(IF(ISNUMBER(AX7:AX9),IF(AX7:AX9>0,IF(BA7:BA9<>"",ROW(AX7:AX9)-MIN(ROW(AX7:AX9))+1))),ROW()-ROW(A$12)+1)),"##0")," ",SUBSTITUTE(INDEX(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&A7:A9,SMALL(IF(ISNUMBER(AX7:AX9),IF(AX7:AX9>0,IF(BA7:BA9<>"",ROW(AX7:AX9)-MIN(ROW(AX7:AX9))+1))),ROW()-ROW(A$12)+1))," ",";")),"")
 Col: BC1
   0
  Formula: IFERROR(CONCATENATE(INDEX(BF7:BF9,SMALL(IF(ISNUMBER(BC7:BC9),IF(BC7:BC9>0,IF(BF7:BF9<>"",ROW(BC7:BC9)-MIN(ROW(BC7:BC9))+1))),ROW()-ROW(A$12)+1)),",",TEXT(INDEX(BC7:BC9,SMALL(IF(ISNUMBER(BC7:BC9),IF(BC7:BC9>0,IF(BF7:BF9<>"",ROW(BC7:BC9)-MIN(ROW(BC7:BC9))+1))),ROW()-ROW(A$12)+1)),"##0"),",",SUBSTITUTE(INDEX(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&A7:A9,SMALL(IF(ISNUMBER(BC7:BC9),IF(BC7:BC9>0,IF(BF7:BF9<>"",ROW(BC7:BC9)-MIN(ROW(BC7:BC9))+1))),ROW()-ROW(A$12)+1)),",",";")),"")
Row: 14
 Col: A1
   "*FILTERED*"
 Col: O1
   0
  Formula: IFERROR(CONCATENATE(INDEX(R7:R9,SMALL(IF(ISNUMBER(O7:O9),IF(O7:O9>0,IF(R7:R9<>"",ROW(O7:O9)-MIN(ROW(O7:O9))+1))),ROW()-ROW(A$12)+1)),",",TEXT(INDEX(O7:O9,SMALL(IF(ISNUMBER(O7:O9),IF(O7:O9>0,IF(R7:R9<>"",ROW(O7:O9)-MIN(ROW(O7:O9))+1))),ROW()-ROW(A$12)+1)),"##0"),",",SUBSTITUTE(INDEX(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&A7:A9,SMALL(IF(ISNUMBER(O7:O9),IF(O7:O9>0,IF(R7:R9<>"",ROW(O7:O9)-MIN(ROW(O7:O9))+1))),ROW()-ROW(A$12)+1)),",",";")),"")
 Col: T1
   0
  Formula: IFERROR(CONCATENATE(TEXT(INDEX(T7:T9,SMALL(IF(ISNUMBER(T7:T9),IF(T7:T9>0,IF(W7:W9<>"",ROW(T7:T9)-MIN(ROW(T7:T9))+1))),ROW()-ROW(A$12)+1)),"##0"),",",INDEX(W7:W9,SMALL(IF(ISNUMBER(T7:T9),IF(T7:T9>0,IF(W7:W9<>"",ROW(T7:T9)-MIN(ROW(T7:T9))+1))),ROW()-ROW(A$12)+1)),",",SUBSTITUTE(INDEX(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&A7:A9,SMALL(IF(ISNUMBER(T7:T9),IF(T7:T9>0,IF(W7:W9<>"",ROW(T7:T9)-MIN(ROW(T7:T9))+1))),ROW()-ROW(A$12)+1)),",",";")),"")
 Col: Y1
   0
  Formula: IFERROR(CONCATENATE(INDEX(AB7:AB9,SMALL(IF(ISNUMBER(Y7:Y9),IF(Y7:Y9>0,IF(AB7:AB9<>"",ROW(Y7:Y9)-MIN(ROW(Y7:Y9))+1))),ROW()-ROW(A$12)+1)),",",TEXT(INDEX(Y7:Y9,SMALL(IF(ISNUMBER(Y7:Y9),IF(Y7:Y9>0,IF(AB7:AB9<>"",ROW(Y7:Y9)-MIN(ROW(Y7:Y9))+1))),ROW()-ROW(A$12)+1)),"##0"),",",LEFT(SUBSTITUTE(SUBSTITUTE(INDEX(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&C7:C9,SMALL(IF(ISNUMBER(Y7:Y9),IF(Y7:Y9>0,IF(AB7:AB9<>"",ROW(Y7:Y9)-MIN(ROW(Y7:Y9))+1))),ROW()-ROW(A$12)+1)),",",";"),"\n",";"),30),",",LEFT(SUBSTITUTE(SUBSTITUTE(INDEX(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&A7:A9,SMALL(IF(ISNUMBER(Y7:Y9),IF(Y7:Y9>0,IF(AB7:AB9<>"",ROW(Y7:Y9)-MIN(ROW(Y7:Y9))+1))),ROW()-ROW(A$12)+1)),",",";"),"\n",";"),30)),"")
 Col: AD1
   0
  Formula: IFERROR(CONCATENATE(TEXT(INDEX(AD7:AD9,SMALL(IF(ISNUMBER(AD7:AD9),IF(AD7:AD9>0,IF(AG7:AG9<>"",ROW(AD7:AD9)-MIN(ROW(AD7:AD9))+1))),ROW()-ROW(A$13)+1)),"##0"),",",SUBSTITUTE(INDEX(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&A7:A9,SMALL(IF(ISNUMBER(AD7:AD9),IF(AD7:AD9>0,IF(AG7:AG9<>"",ROW(AD7:AD9)-MIN(ROW(AD7:AD9))+1))),ROW()-ROW(A$13)+1)),",",";"),",",SUBSTITUTE(INDEX(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&H7:H9,SMALL(IF(ISNUMBER(AD7:AD9),IF(AD7:AD9>0,IF(AG7:AG9<>"",ROW(AD7:AD9)-MIN(ROW(AD7:AD9))+1))),ROW()-ROW(A$13)+1)),",",";"),",",INDEX(AG7:AG9,SMALL(IF(ISNUMBER(AD7:AD9),IF(AD7:AD9>0,IF(AG7:AG9<>"",ROW(AD7:AD9)-MIN(ROW(AD7:AD9))+1))),ROW()-ROW(A$13)+1))),"")
 Col: AI1
   0
  Formula: IFERROR(CONCATENATE(INDEX(AL7:AL9,SMALL(IF(ISNUMBER(AI7:AI9),IF(AI7:AI9>0,IF(AL7:AL9<>"",ROW(AI7:AI9)-MIN(ROW(AI7:AI9))+1))),ROW()-ROW(A$12)+1)),"|",TEXT(INDEX(AI7:AI9,SMALL(IF(ISNUMBER(AI7:AI9),IF(AI7:AI9>0,IF(AL7:AL9<>"",ROW(AI7:AI9)-MIN(ROW(AI7:AI9))+1))),ROW()-ROW(A$12)+1)),"##0"),"|",SUBSTITUTE(SUBSTITUTE(INDEX(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&A7:A9,SMALL(IF(ISNUMBER(AI7:AI9),IF(AI7:AI9>0,IF(AL7:AL9<>"",ROW(AI7:AI9)-MIN(ROW(AI7:AI9))+1))),ROW()-ROW(A$12)+1)),"|",";")," ","_")),"")
 Col: AN1
   0
  Formula: IFERROR(CONCATENATE(INDEX(AQ7:AQ9,SMALL(IF(ISNUMBER(AN7:AN9),IF(AN7:AN9>0,IF(AQ7:AQ9<>"",ROW(AN7:AN9)-MIN(ROW(AN7:AN9))+1))),ROW()-ROW(A$12)+1)),",",TEXT(INDEX(AN7:AN9,SMALL(IF(ISNUMBER(AN7:AN9),IF(AN7:AN9>0,IF(AQ7:AQ9<>"",ROW(AN7:AN9)-MIN(ROW(AN7:AN9))+1))),ROW()-ROW(A$12)+1)),"##0"),",",SUBSTITUTE(SUBSTITUTE(INDEX(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&A7:A9,SMALL(IF(ISNUMBER(AN7:AN9),IF(AN7:AN9>0,IF(AQ7:AQ9<>"",ROW(AN7:AN9)-MIN(ROW(AN7:AN9))+1))),ROW()-ROW(A$12)+1)),",",";"),"\n",";"),",",SUBSTITUTE(SUBSTITUTE(INDEX(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&C7:C9,SMALL(IF(ISNUMBER(AN7:AN9),IF(AN7:AN9>0,IF(AQ7:AQ9<>"",ROW(AN7:AN9)-MIN(ROW(AN7:AN9))+1))),ROW()-ROW(A$12)+1)),",",";"),"\n",";")),"")
 Col: AS1
   0
  Formula: IFERROR(CONCATENATE(INDEX(AV7:AV9,SMALL(IF(ISNUMBER(AS7:AS9),IF(AS7:AS9>0,IF(AV7:AV9<>"",ROW(AS7:AS9)-MIN(ROW(AS7:AS9))+1))),ROW()-ROW(A$12)+1)),",",TEXT(INDEX(AS7:AS9,SMALL(IF(ISNUMBER(AS7:AS9),IF(AS7:AS9>0,IF(AV7:AV9<>"",ROW(AS7:AS9)-MIN(ROW(AS7:AS9))+1))),ROW()-ROW(A$12)+1)),"##0"),",",,",",,",",,",",INDEX(J7:J9,SMALL(IF(ISNUMBER(AS7:AS9),IF(AS7:AS9>0,IF(AV7:AV9<>"",ROW(AS7:AS9)-MIN(ROW(AS7:AS9))+1))),ROW()-ROW(A$12)+1)),",",SUBSTITUTE(INDEX(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&A7:A9,SMALL(IF(ISNUMBER(AS7:AS9),IF(AS7:AS9>0,IF(AV7:AV9<>"",ROW(AS7:AS9)-MIN(ROW(AS7:AS9))+1))),ROW()-ROW(A$12)+1)),",",";")),"")
 Col: AX1
   0
  Formula: IFERROR(CONCATENATE(INDEX(BA7:BA9,SMALL(IF(ISNUMBER(AX7:AX9),IF(AX7:AX9>0,IF(BA7:BA9<>"",ROW(AX7:AX9)-MIN(ROW(AX7:AX9))+1))),ROW()-ROW(A$12)+1))," ",TEXT(INDEX(AX7:AX9,SMALL(IF(ISNUMBER(AX7:AX9),IF(AX7:AX9>0,IF(BA7:BA9<>"",ROW(AX7:AX9)-MIN(ROW(AX7:AX9))+1))),ROW()-ROW(A$12)+1)),"##0")," ",SUBSTITUTE(INDEX(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&A7:A9,SMALL(IF(ISNUMBER(AX7:AX9),IF(AX7:AX9>0,IF(BA7:BA9<>"",ROW(AX7:AX9)-MIN(ROW(AX7:AX9))+1))),ROW()-ROW(A$12)+1))," ",";")),"")
 Col: BC1
   0
  Formula: IFERROR(CONCATENATE(INDEX(BF7:BF9,SMALL(IF(ISNUMBER(BC7:BC9),IF(BC7:BC9>0,IF(BF7:BF9<>"",ROW(BC7:BC9)-MIN(ROW(BC7:BC9))+1))),ROW()-ROW(A$12)+1)),",",TEXT(INDEX(BC7:BC9,SMALL(IF(ISNUMBER(BC7:BC9),IF(BC7:BC9>0,IF(BF7:BF9<>"",ROW(BC7:BC9)-MIN(ROW(BC7:BC9))+1))),ROW()-ROW(A$12)+1)),"##0"),",",SUBSTITUTE(INDEX(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&A7:A9,SMALL(IF(ISNUMBER(BC7:BC9),IF(BC7:BC9>0,IF(BF7:BF9<>"",ROW(BC7:BC9)-MIN(ROW(BC7:BC9))+1))),ROW()-ROW(A$12)+1)),",",";")),"")
Row: 15
 Col: AD1
   0
  Formula: IFERROR(CONCATENATE(TEXT(INDEX(AD7:AD9,SMALL(IF(ISNUMBER(AD7:AD9),IF(AD7:AD9>0,IF(AG7:AG9<>"",ROW(AD7:AD9)-MIN(ROW(AD7:AD9))+1))),ROW()-ROW(A$13)+1)),"##0"),",",SUBSTITUTE(INDEX(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&A7:A9,SMALL(IF(ISNUMBER(AD7:AD9),IF(AD7:AD9>0,IF(AG7:AG9<>"",ROW(AD7:AD9)-MIN(ROW(AD7:AD9))+1))),ROW()-ROW(A$13)+1)),",",";"),",",SUBSTITUTE(INDEX(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&H7:H9,SMALL(IF(ISNUMBER(AD7:AD9),IF(AD7:AD9>0,IF(AG7:AG9<>"",ROW(AD7:AD9)-MIN(ROW(AD7:AD9))+1))),ROW()-ROW(A$13)+1)),",",";"),",",INDEX(AG7:AG9,SMALL(IF(ISNUMBER(AD7:AD9),IF(AD7:AD9>0,IF(AG7:AG9<>"",ROW(AD7:AD9)-MIN(ROW(AD7:AD9))+1))),ROW()-ROW(A$13)+1))),"")
