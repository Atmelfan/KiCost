Variables:
BoardQty = 'LedTest'!$G$1
PURCHASE_DESCRIPTION = 'LedTest'!$G$15
TotalCost = 'LedTest'!$G$3
USD_GBP = 'LedTest'!$C$15
--------------------------------------------------------------------------------
Row: 1
 Col: A
   "Prj:"
 Col: B
   "LedTest.xml"
 Col: F
   "Board Qty:"
 Col: G
   100
Row: 2
 Col: A
   "Co.:"
 Col: F
   "Unit Cost:"
 Col: G
   0.361
  Formula: TotalCost/BoardQty
Row: 3
 Col: A
   "Prj date:"
 Col: B
   "12/21/2015 9:45:38 AM"
 Col: F
   "Total Cost:"
 Col: G
   36.1
  Formula: SUM(G7:G12)
 Col: K
   0
  Formula: SUM(K7:K12)
 Col: L
   "0 of 6 parts found"
  Formula: (COUNTA(K7:K12)&" of "&ROWS(K7:K12)&" parts found")
 Col: P
   46.95
  Formula: SUM(P7:P12)
 Col: Q
   "1 of 6 parts found"
  Formula: (COUNTA(P7:P12)&" of "&ROWS(P7:P12)&" parts found")
 Col: U
   0
  Formula: SUM(U7:U12)
 Col: V
   "0 of 6 parts found"
  Formula: (COUNTA(U7:U12)&" of "&ROWS(U7:U12)&" parts found")
 Col: Z
   0
  Formula: SUM(Z7:Z12)
 Col: AA
   "0 of 6 parts found"
  Formula: (COUNTA(Z7:Z12)&" of "&ROWS(Z7:Z12)&" parts found")
 Col: AE
   57.1
  Formula: SUM(AE7:AE12)
 Col: AF
   "1 of 6 parts found"
  Formula: (COUNTA(AE7:AE12)&" of "&ROWS(AE7:AE12)&" parts found")
 Col: AJ
   36.1
  Formula: SUM(AJ7:AJ12)
 Col: AK
   "1 of 6 parts found"
  Formula: (COUNTA(AJ7:AJ12)&" of "&ROWS(AJ7:AJ12)&" parts found")
 Col: AO
   72.6497
  Formula: SUM(AO7:AO12)
 Col: AP
   "1 of 6 parts found"
  Formula: (COUNTA(AO7:AO12)&" of "&ROWS(AO7:AO12)&" parts found")
 Col: AT
   0
  Formula: SUM(AT7:AT12)
 Col: AU
   "0 of 6 parts found"
  Formula: (COUNTA(AT7:AT12)&" of "&ROWS(AT7:AT12)&" parts found")
Row: 4
 Col: A
   "$ date:"
 Col: B
   *FILTERED*
Row: 5
 Col: A
   "Global Part Info"
 Col: H
   "Arrow"
 Col: M
   "Digi-Key"
 Col: R
   "Farnell"
 Col: W
   "LCSC"
 Col: AB
   "Mouser"
 Col: AG
   "Newark"
 Col: AL
   "RS Components"
 Col: AQ
   "TME"
Row: 6
 Col: A
   "Refs"
 Col: B
   "Value"
 Col: C
   "Footprint"
 Col: D
   "Manf#"
 Col: E
   "Qty"
 Col: F
   "Unit$"
 Col: G
   "Ext$"
 Col: H
   "Avail"
 Col: I
   "Purch"
 Col: J
   "Unit$"
 Col: K
   "Ext$"
 Col: L
   "Cat#"
 Col: M
   "Avail"
 Col: N
   "Purch"
 Col: O
   "Unit$"
 Col: P
   "Ext$"
 Col: Q
   "Cat#"
 Col: R
   "Avail"
 Col: S
   "Purch"
 Col: T
   "Unit$"
 Col: U
   "Ext$"
 Col: V
   "Cat#"
 Col: W
   "Avail"
 Col: X
   "Purch"
 Col: Y
   "Unit$"
 Col: Z
   "Ext$"
 Col: AA
   "Cat#"
 Col: AB
   "Avail"
 Col: AC
   "Purch"
 Col: AD
   "Unit$"
 Col: AE
   "Ext$"
 Col: AF
   "Cat#"
 Col: AG
   "Avail"
 Col: AH
   "Purch"
 Col: AI
   "Unit$"
 Col: AJ
   "Ext$"
 Col: AK
   "Cat#"
 Col: AL
   "Avail"
 Col: AM
   "Purch"
 Col: AN
   "Unit$"
 Col: AO
   "Ext$"
 Col: AP
   "Cat#"
 Col: AQ
   "Avail"
 Col: AR
   "Purch"
 Col: AS
   "Unit$"
 Col: AT
   "Ext$"
 Col: AU
   "Cat#"
Row: 7
 Col: A
   "D1-D8"
 Col: B
   "Led_Small"
 Col: E
   800
  Formula: CEILING(BoardQty*8,1)
 Col: F
   0
  Formula: MINA(J7,O7,T7,Y7,AD7,AI7,AN7,AS7)
 Col: G
   0
  Formula: IFERROR(E7*F7,"")
Row: 8
 Col: A
   "IC1"
 Col: B
   "ATTINY13A-S"
 Col: C
   "SOIC-14_N"
 Col: E
   100
  Formula: CEILING(BoardQty*1,1)
 Col: F
   0
  Formula: MINA(J8,O8,T8,Y8,AD8,AI8,AN8,AS8)
 Col: G
   0
  Formula: IFERROR(E8*F8,"")
Row: 9
 Col: A
   "P1"
 Col: B
   "CONN_02X03"
 Col: C
   "ICSP-6pin"
 Col: E
   100
  Formula: CEILING(BoardQty*1,1)
 Col: F
   0
  Formula: MINA(J9,O9,T9,Y9,AD9,AI9,AN9,AS9)
 Col: G
   0
  Formula: IFERROR(E9*F9,"")
Row: 10
 Col: A
   "P2"
 Col: B
   "CONN_01X03"
 Col: C
   "Jumper_3pin"
 Col: E
   100
  Formula: CEILING(BoardQty*1,1)
 Col: F
   0
  Formula: MINA(J10,O10,T10,Y10,AD10,AI10,AN10,AS10)
 Col: G
   0
  Formula: IFERROR(E10*F10,"")
Row: 11
 Col: A
   "R1-R8"
 Col: B
   "R_Small"
 Col: E
   800
  Formula: CEILING(BoardQty*8,1)
 Col: F
   0
  Formula: MINA(J11,O11,T11,Y11,AD11,AI11,AN11,AS11)
 Col: G
   0
  Formula: IFERROR(E11*F11,"")
Row: 12
 Col: A
   "U1"
 Col: B
   "LTV-847"
 Col: C
   "DIP-16"
 Col: D
   <a href="http://datasheet.octopart.com/LTV-846S-Lite-On-datasheet-125263.pdf">LTV-846S</a>
 Col: E
   100
  Formula: CEILING(BoardQty*1.0,1)
 Col: F
   0.361
  Formula: MINA(J12,O12,T12,Y12,AD12,AI12,AN12,AS12)
 Col: G
   36.1
  Formula: IFERROR(E12*F12,"")
 Col: M
   73
 Col: O
   0.4695
  Formula: IFERROR(LOOKUP(IF(N12="",E12,N12),{0,1,10,100,500,1000,2000,5000,10000,25000},{0.0,1.0,0.634,0.4695,0.43146,0.35532,0.33756,0.32994,0.32233,0.31725}),"")
 Col: P
   46.95
  Formula: IFERROR(IF(N12="",E12,N12)*O12,"")
 Col: Q
   <a href="https://octopart.com/click/track?ai=8078&sig=061a88f&sid=459&ppid=704234&vpid=1121089&ct=offers">160-1365-5-ND</a>
 Col: AB
   3319
 Col: AD
   0.571
  Formula: IFERROR(LOOKUP(IF(AC12="",E12,AC12),{0,1,10,50,100,1000,10000},{0.0,0.82,0.68,0.68,0.571,0.356,0.318}),"")
 Col: AE
   57.1
  Formula: IFERROR(IF(AC12="",E12,AC12)*AD12,"")
 Col: AF
   <a href="https://octopart.com/click/track?ai=8078&sig=09e28c4&sid=2401&ppid=704234&vpid=37598203&ct=offers">859LTV846S</a>
 Col: AG
   "NonStk"
 Col: AI
   0.361
  Formula: IFERROR(LOOKUP(IF(AH12="",E12,AH12),{0,1,25,30,60},{0.0,0.389,0.389,0.379,0.361}),"")
 Col: AJ
   36.1
  Formula: IFERROR(IF(AH12="",E12,AH12)*AI12,"")
 Col: AK
   <a href="https://octopart.com/click/track?c=1&ai=8078&sig=089e334&sid=2402&ppid=704234&vpid=634310746&ct=offers">61AC0129</a>
 Col: AL
   200
 Col: AN
   0.726497160737
  Formula: IFERROR(USD_GBP*LOOKUP(IF(AM12="",E12,AM12),{0,1,25},{0.0,0.528,0.528}),"")
 Col: AO
   72.6497
  Formula: IFERROR(IF(AM12="",E12,AM12)*AN12,"")
 Col: AP
   <a href="https://octopart.com/click/track?ai=8078&sig=02b239a&sid=10022&ppid=704234&vpid=501121902&ct=offers">1689678</a>
Row: 14
 Col: B
   "Used currency rates:"
 Col: F
   "Total Purchase:"
 Col: G
   0
  Formula: SUM(K14,P14,U14,Z14,AE14,AJ14,AO14,AT14)
 Col: H
   <a href="https://www.arrow.com/en/bom-tool/">Buy here</a>
 Col: I
  Formula: IFERROR(IF(OR(I7:I12),COUNTIFS(I7:I12,">0",K7:K12,"<>")&" of "&(ROWS(K7:K12)-COUNTBLANK(K7:K12))&" parts purchased",""),"")
 Col: K
   0
  Formula: SUMIF(I7:I12,">0",K7:K12)
 Col: M
   <a href="https://www.digikey.com/ordering/shoppingcart">Buy here</a>
 Col: N
  Formula: IFERROR(IF(OR(N7:N12),COUNTIFS(N7:N12,">0",P7:P12,"<>")&" of "&(ROWS(P7:P12)-COUNTBLANK(P7:P12))&" parts purchased",""),"")
 Col: P
   0
  Formula: SUMIF(N7:N12,">0",P7:P12)
 Col: R
   <a href="https://fr.farnell.com/en-FR/quick-order?isQuickPaste=true">Buy here</a>
 Col: S
  Formula: IFERROR(IF(OR(S7:S12),COUNTIFS(S7:S12,">0",U7:U12,"<>")&" of "&(ROWS(U7:U12)-COUNTBLANK(U7:U12))&" parts purchased",""),"")
 Col: U
   0
  Formula: SUMIF(S7:S12,">0",U7:U12)
 Col: W
   <a href="https://lcsc.com/bom.html">Buy here</a>
 Col: X
  Formula: IFERROR(IF(OR(X7:X12),COUNTIFS(X7:X12,">0",Z7:Z12,"<>")&" of "&(ROWS(Z7:Z12)-COUNTBLANK(Z7:Z12))&" parts purchased",""),"")
 Col: Z
   0
  Formula: SUMIF(X7:X12,">0",Z7:Z12)
 Col: AB
   <a href="https://mouser.com/bom/">Buy here</a>
 Col: AC
  Formula: IFERROR(IF(OR(AC7:AC12),COUNTIFS(AC7:AC12,">0",AE7:AE12,"<>")&" of "&(ROWS(AE7:AE12)-COUNTBLANK(AE7:AE12))&" parts purchased",""),"")
 Col: AE
   0
  Formula: SUMIF(AC7:AC12,">0",AE7:AE12)
 Col: AG
   <a href="https://www.newark.com/quick-order?isQuickPaste=true">Buy here</a>
 Col: AH
  Formula: IFERROR(IF(OR(AH7:AH12),COUNTIFS(AH7:AH12,">0",AJ7:AJ12,"<>")&" of "&(ROWS(AJ7:AJ12)-COUNTBLANK(AJ7:AJ12))&" parts purchased",""),"")
 Col: AJ
   0
  Formula: SUMIF(AH7:AH12,">0",AJ7:AJ12)
 Col: AL
   <a href="https://uk.rs-online.com/web/mylists/manualQuotes.html?method=showEnquiryCreationPage&mode=new">Buy here</a>
 Col: AM
  Formula: IFERROR(IF(OR(AM7:AM12),COUNTIFS(AM7:AM12,">0",AO7:AO12,"<>")&" of "&(ROWS(AO7:AO12)-COUNTBLANK(AO7:AO12))&" parts purchased",""),"")
 Col: AO
   0
  Formula: SUMIF(AM7:AM12,">0",AO7:AO12)
 Col: AQ
   <a href="https://www.tme.eu/en/Profile/QuickBuy/load.html">Buy here</a>
 Col: AR
  Formula: IFERROR(IF(OR(AR7:AR12),COUNTIFS(AR7:AR12,">0",AT7:AT12,"<>")&" of "&(ROWS(AT7:AT12)-COUNTBLANK(AT7:AT12))&" parts purchased",""),"")
 Col: AT
   0
  Formula: SUMIF(AR7:AR12,">0",AT7:AT12)
Row: 15
 Col: B
   "USD($)/GBP(Â£):"
 Col: C
   1.37594159231
 Col: F
   "Purchase description:"
 Col: I
  Formula: CONCATENATE(I22,I23,I24,I25,I26,I27)
 Col: N
  Formula: CONCATENATE(N22,N23,N24,N25,N26,N27)
 Col: S
  Formula: CONCATENATE(S22,S23,S24,S25,S26,S27)
 Col: X
   "Copy this header and order to a CSV
file and use it for JLCPCB 
manufacturer PCB house.
The multipart components that use
"#" symbol are not allowed by JLCPCB."
  Formula: CONCATENATE(X28,X22,X23,X24,X25,X26,X27)
 Col: AC
  Formula: CONCATENATE(AC22,AC23,AC24,AC25,AC26,AC27)
 Col: AH
  Formula: CONCATENATE(AH22,AH23,AH24,AH25,AH26,AH27)
 Col: AM
  Formula: CONCATENATE(AM22,AM23,AM24,AM25,AM26,AM27)
 Col: AR
  Formula: CONCATENATE(AR22,AR23,AR24,AR25,AR26,AR27)
Row: 17
 Col: A
   "*FILTERED*"
Row: 22
 Col: I
  Formula: IF(ISNUMBER(I7:I12)*(I7:I12>0)*(L7:L12<>""),L7:L12&","&TEXT(I7:I12,"##0")&","&SUBSTITUTE(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&A7:A12,",",";")&CHAR(10),"")
 Col: N
  Formula: IF(ISNUMBER(N7:N12)*(N7:N12>0)*(Q7:Q12<>""),TEXT(N7:N12,"##0")&","&Q7:Q12&","&SUBSTITUTE(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&A7:A12,",",";")&CHAR(10),"")
 Col: S
  Formula: IF(ISNUMBER(S7:S12)*(S7:S12>0)*(V7:V12<>""),V7:V12&","&TEXT(S7:S12,"##0")&","&""&","&LEFT(SUBSTITUTE(SUBSTITUTE(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&A7:A12,",",";"),"\n",";"),30)&CHAR(10),"")
 Col: X
  Formula: IF(ISNUMBER(X7:X12)*(X7:X12>0)*(AA7:AA12<>""),TEXT(X7:X12,"##0")&","&SUBSTITUTE(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&A7:A12,",",";")&","&SUBSTITUTE(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&C7:C12,",",";")&","&AA7:AA12&CHAR(10),"")
 Col: AC
  Formula: IF(ISNUMBER(AC7:AC12)*(AC7:AC12>0)*(AF7:AF12<>""),AF7:AF12&"|"&TEXT(AC7:AC12,"##0")&"|"&SUBSTITUTE(SUBSTITUTE(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&A7:A12,"|",";")," ","_")&CHAR(10),"")
 Col: AH
  Formula: IF(ISNUMBER(AH7:AH12)*(AH7:AH12>0)*(AK7:AK12<>""),AK7:AK12&","&TEXT(AH7:AH12,"##0")&","&SUBSTITUTE(SUBSTITUTE(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&A7:A12,",",";"),"\n",";")&","&""&CHAR(10),"")
 Col: AM
  Formula: IF(ISNUMBER(AM7:AM12)*(AM7:AM12>0)*(AP7:AP12<>""),AP7:AP12&","&TEXT(AM7:AM12,"##0")&","&""&","&""&","&""&","&D7:D12&","&SUBSTITUTE(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&A7:A12,",",";")&CHAR(10),"")
 Col: AR
  Formula: IF(ISNUMBER(AR7:AR12)*(AR7:AR12>0)*(AU7:AU12<>""),AU7:AU12&" "&TEXT(AR7:AR12,"##0")&" "&SUBSTITUTE(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&A7:A12," ",";")&CHAR(10),"")
Row: 23
 Col: I
   0
 Col: N
   0
 Col: S
   0
 Col: X
   0
 Col: AC
   0
 Col: AH
   0
 Col: AM
   0
 Col: AR
   0
Row: 24
 Col: I
   0
 Col: N
   0
 Col: S
   0
 Col: X
   0
 Col: AC
   0
 Col: AH
   0
 Col: AM
   0
 Col: AR
   0
Row: 25
 Col: I
   0
 Col: N
   0
 Col: S
   0
 Col: X
   0
 Col: AC
   0
 Col: AH
   0
 Col: AM
   0
 Col: AR
   0
Row: 26
 Col: I
   0
 Col: N
   0
 Col: S
   0
 Col: X
   0
 Col: AC
   0
 Col: AH
   0
 Col: AM
   0
 Col: AR
   0
Row: 27
 Col: I
   0
 Col: N
   0
 Col: S
   0
 Col: X
   0
 Col: AC
   0
 Col: AH
   0
 Col: AM
   0
 Col: AR
   0
Row: 28
 Col: X
  Formula: IFERROR(IF(COUNTIFS(X7:X12,">0",Z7:Z12,"<>")>0,"Quantity,Comment,Designator,Footprint,LCSC Part #(optional)"&CHAR(10),""),"")
