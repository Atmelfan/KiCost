Variables:
BoardQty = 'subparts_err1'!$I$1
PURCHASE_DESCRIPTION = 'subparts_err1'!$I$11
TotalCost = 'subparts_err1'!$I$3
USD_GBP = 'subparts_err1'!$C$11
--------------------------------------------------------------------------------
Row: 1
 Col: A
   "Prj:"
 Col: B
   "*FILTERED*"
 Col: H
   "Board Qty:"
 Col: I
   100
Row: 2
 Col: A
   "Co.:"
 Col: B
   "KiBot"
 Col: H
   "Unit Cost:"
 Col: I
   2.95
  Formula: TotalCost/BoardQty
Row: 3
 Col: A
   "Prj date:"
 Col: B
   "jue 18 mar 2021 15:46:06"
 Col: H
   "Total Cost:"
 Col: I
   295
  Formula: SUM(I7:I8)
 Col: M
   0
  Formula: SUM(M7:M8)
 Col: N
   "0 of 2 parts found"
  Formula: (COUNTA(M7:M8)&" of "&ROWS(M7:M8)&" parts found")
 Col: R
   145.02
  Formula: SUM(R7:R8)
 Col: S
   "1 of 2 parts found"
  Formula: (COUNTA(R7:R8)&" of "&ROWS(R7:R8)&" parts found")
 Col: W
   211.895
  Formula: SUM(W7:W8)
 Col: X
   "1 of 2 parts found"
  Formula: (COUNTA(W7:W8)&" of "&ROWS(W7:W8)&" parts found")
 Col: AB
   0
  Formula: SUM(AB7:AB8)
 Col: AC
   "0 of 2 parts found"
  Formula: (COUNTA(AB7:AB8)&" of "&ROWS(AB7:AB8)&" parts found")
 Col: AG
   295
  Formula: SUM(AG7:AG8)
 Col: AH
   "2 of 2 parts found"
  Formula: (COUNTA(AG7:AG8)&" of "&ROWS(AG7:AG8)&" parts found")
 Col: AL
   131
  Formula: SUM(AL7:AL8)
 Col: AM
   "1 of 2 parts found"
  Formula: (COUNTA(AL7:AL8)&" of "&ROWS(AL7:AL8)&" parts found")
 Col: AQ
   0
  Formula: SUM(AQ7:AQ8)
 Col: AR
   "0 of 2 parts found"
  Formula: (COUNTA(AQ7:AQ8)&" of "&ROWS(AQ7:AQ8)&" parts found")
 Col: AV
   0
  Formula: SUM(AV7:AV8)
 Col: AW
   "0 of 2 parts found"
  Formula: (COUNTA(AV7:AV8)&" of "&ROWS(AV7:AV8)&" parts found")
Row: 4
 Col: A
   "$ date:"
 Col: B
   *FILTERED*
Row: 5
 Col: A
   "Global Part Info"
 Col: J
   "Arrow"
 Col: O
   "Digi-Key"
 Col: T
   "Farnell"
 Col: Y
   "LCSC"
 Col: AD
   "Mouser"
 Col: AI
   "Newark"
 Col: AN
   "RS Components"
 Col: AS
   "TME"
Row: 6
 Col: A
   "Refs"
 Col: B
   "Value"
 Col: C
   "Desc"
 Col: D
   "Footprint"
 Col: E
   "Manf"
 Col: F
   "Manf#"
 Col: G
   "Qty"
 Col: H
   "Unit$"
 Col: I
   "Ext$"
 Col: J
   "Avail"
 Col: K
   "Purch"
 Col: L
   "Unit$"
 Col: M
   "Ext$"
 Col: N
   "Cat#"
 Col: O
   "Avail"
 Col: P
   "Purch"
 Col: Q
   "Unit$"
 Col: R
   "Ext$"
 Col: S
   "Cat#"
 Col: T
   "Avail"
 Col: U
   "Purch"
 Col: V
   "Unit$"
 Col: W
   "Ext$"
 Col: X
   "Cat#"
 Col: Y
   "Avail"
 Col: Z
   "Purch"
 Col: AA
   "Unit$"
 Col: AB
   "Ext$"
 Col: AC
   "Cat#"
 Col: AD
   "Avail"
 Col: AE
   "Purch"
 Col: AF
   "Unit$"
 Col: AG
   "Ext$"
 Col: AH
   "Cat#"
 Col: AI
   "Avail"
 Col: AJ
   "Purch"
 Col: AK
   "Unit$"
 Col: AL
   "Ext$"
 Col: AM
   "Cat#"
 Col: AN
   "Avail"
 Col: AO
   "Purch"
 Col: AP
   "Unit$"
 Col: AQ
   "Ext$"
 Col: AR
   "Cat#"
 Col: AS
   "Avail"
 Col: AT
   "Purch"
 Col: AU
   "Unit$"
 Col: AV
   "Ext$"
 Col: AW
   "Cat#"
Row: 7
 Col: A
   "Q1#1"
 Col: B
   "2N2222A - p1/2"
 Col: C
   "TRANS NPN 40V 0.8A TO-18 + Heatsink"
 Col: D
   "TO-18-3"
 Col: F
   "2N2222A PBFREE"
 Col: G
   100
  Formula: CEILING(BoardQty*1.0,1)
 Col: H
   1.64
  Formula: MINA(L7,Q7,V7,AA7,AF7,AK7,AP7,AU7)
 Col: I
   164
  Formula: IFERROR(G7*H7,"")
 Col: AD
   30803
 Col: AF
   1.64
  Formula: IFERROR(LOOKUP(IF(AE7="",G7,AE7),{0,1,10,50,100,1000,10000},{0.0,2.48,1.99,1.99,1.64,1.18,1.08}),"")
 Col: AG
   164
  Formula: IFERROR(IF(AE7="",G7,AE7)*AF7,"")
 Col: AH
   <a href="https://octopart.com/click/track?ai=8078&sig=0bec95d&sid=2401&ppid=38924313&vpid=614092373&ct=offers">6102N2222A</a>
Row: 8
 Col: A
   "Q1#2"
 Col: B
   "2N2222A - p2/2"
 Col: C
   "TRANS NPN 40V 0.8A TO-18 + Heatsink"
 Col: D
   "TO-18-3"
 Col: E
   "Aavid"
 Col: F
   "322400B00000G"
 Col: G
   100
  Formula: CEILING(BoardQty*1.0,1)
 Col: H
   1.31
  Formula: MINA(L8,Q8,V8,AA8,AF8,AK8,AP8,AU8)
 Col: I
   131
  Formula: IFERROR(G8*H8,"")
 Col: O
   2753
 Col: Q
   1.4502
  Formula: IFERROR(LOOKUP(IF(P8="",G8,P8),{0,1,10,25,50,100,250,500,1000,5000},{0.0,1.71,1.621,1.5784,1.5356,1.4502,1.36492,1.27962,1.19432,1.15167}),"")
 Col: R
   145.02
  Formula: IFERROR(IF(P8="",G8,P8)*Q8,"")
 Col: S
   <a href="https://octopart.com/click/track?ai=8078&sig=0a4bbfc&sid=459&ppid=381806&vpid=1187617&ct=offers">HS100-ND</a>
 Col: T
   717
 Col: V
   2.11895005215
  Formula: IFERROR(USD_GBP*LOOKUP(IF(U8="",G8,U8),{0,1,10,25,50,100},{0.0,2.63,2.1,1.98,1.85,1.54}),"")
 Col: W
   211.895
  Formula: IFERROR(IF(U8="",G8,U8)*V8,"")
 Col: X
   <a href="https://octopart.com/click/track?ai=8078&sig=0e43cfc&sid=819&ppid=381806&vpid=138099605&ct=offers">2295717</a>
 Col: AD
   2099
 Col: AF
   1.31
  Formula: IFERROR(LOOKUP(IF(AE8="",G8,AE8),{0,1,10,50,100,1000,10000},{0.0,1.54,1.47,1.38,1.31,1.08,1.04}),"")
 Col: AG
   131
  Formula: IFERROR(IF(AE8="",G8,AE8)*AF8,"")
 Col: AH
   <a href="https://octopart.com/click/track?ai=8078&sig=00ca156&sid=2401&ppid=381806&vpid=37663924&ct=offers">532322400B00</a>
 Col: AI
   713
 Col: AK
   1.31
  Formula: IFERROR(LOOKUP(IF(AJ8="",G8,AJ8),{0,1,10,25,50,100,250,3000},{0.0,1.54,1.47,1.42,1.38,1.31,1.24,1.4}),"")
 Col: AL
   131
  Formula: IFERROR(IF(AJ8="",G8,AJ8)*AK8,"")
 Col: AM
   <a href="https://octopart.com/click/track?ai=8078&sig=0ae40ed&sid=2402&ppid=381806&vpid=605875841&ct=offers">99Y9862</a>
Row: 10
 Col: B
   "Used currency rates:"
 Col: H
   "Total Purchase:"
 Col: I
   0
  Formula: SUM(M10,R10,W10,AB10,AG10,AL10,AQ10,AV10)
 Col: J
   <a href="https://www.arrow.com/en/bom-tool/">Buy here</a>
 Col: K
  Formula: IFERROR(IF(OR(K7:K8),COUNTIFS(K7:K8,">0",M7:M8,"<>")&" of "&(ROWS(M7:M8)-COUNTBLANK(M7:M8))&" parts purchased",""),"")
 Col: M
   0
  Formula: SUMIF(K7:K8,">0",M7:M8)
 Col: O
   <a href="https://www.digikey.com/ordering/shoppingcart">Buy here</a>
 Col: P
  Formula: IFERROR(IF(OR(P7:P8),COUNTIFS(P7:P8,">0",R7:R8,"<>")&" of "&(ROWS(R7:R8)-COUNTBLANK(R7:R8))&" parts purchased",""),"")
 Col: R
   0
  Formula: SUMIF(P7:P8,">0",R7:R8)
 Col: T
   <a href="https://fr.farnell.com/en-FR/quick-order?isQuickPaste=true">Buy here</a>
 Col: U
  Formula: IFERROR(IF(OR(U7:U8),COUNTIFS(U7:U8,">0",W7:W8,"<>")&" of "&(ROWS(W7:W8)-COUNTBLANK(W7:W8))&" parts purchased",""),"")
 Col: W
   0
  Formula: SUMIF(U7:U8,">0",W7:W8)
 Col: Y
   <a href="https://lcsc.com/bom.html">Buy here</a>
 Col: Z
  Formula: IFERROR(IF(OR(Z7:Z8),COUNTIFS(Z7:Z8,">0",AB7:AB8,"<>")&" of "&(ROWS(AB7:AB8)-COUNTBLANK(AB7:AB8))&" parts purchased",""),"")
 Col: AB
   0
  Formula: SUMIF(Z7:Z8,">0",AB7:AB8)
 Col: AD
   <a href="https://mouser.com/bom/">Buy here</a>
 Col: AE
  Formula: IFERROR(IF(OR(AE7:AE8),COUNTIFS(AE7:AE8,">0",AG7:AG8,"<>")&" of "&(ROWS(AG7:AG8)-COUNTBLANK(AG7:AG8))&" parts purchased",""),"")
 Col: AG
   0
  Formula: SUMIF(AE7:AE8,">0",AG7:AG8)
 Col: AI
   <a href="https://www.newark.com/quick-order?isQuickPaste=true">Buy here</a>
 Col: AJ
  Formula: IFERROR(IF(OR(AJ7:AJ8),COUNTIFS(AJ7:AJ8,">0",AL7:AL8,"<>")&" of "&(ROWS(AL7:AL8)-COUNTBLANK(AL7:AL8))&" parts purchased",""),"")
 Col: AL
   0
  Formula: SUMIF(AJ7:AJ8,">0",AL7:AL8)
 Col: AN
   <a href="https://uk.rs-online.com/web/mylists/manualQuotes.html?method=showEnquiryCreationPage&mode=new">Buy here</a>
 Col: AO
  Formula: IFERROR(IF(OR(AO7:AO8),COUNTIFS(AO7:AO8,">0",AQ7:AQ8,"<>")&" of "&(ROWS(AQ7:AQ8)-COUNTBLANK(AQ7:AQ8))&" parts purchased",""),"")
 Col: AQ
   0
  Formula: SUMIF(AO7:AO8,">0",AQ7:AQ8)
 Col: AS
   <a href="https://www.tme.eu/en/Profile/QuickBuy/load.html">Buy here</a>
 Col: AT
  Formula: IFERROR(IF(OR(AT7:AT8),COUNTIFS(AT7:AT8,">0",AV7:AV8,"<>")&" of "&(ROWS(AV7:AV8)-COUNTBLANK(AV7:AV8))&" parts purchased",""),"")
 Col: AV
   0
  Formula: SUMIF(AT7:AT8,">0",AV7:AV8)
Row: 11
 Col: B
   "USD($)/GBP(Â£):"
 Col: C
   1.37594159231
 Col: H
   "Purchase description:"
 Col: K
  Formula: CONCATENATE(K14,K15)
 Col: P
  Formula: CONCATENATE(P14,P15)
 Col: U
  Formula: CONCATENATE(U14,U15)
 Col: Z
   "Copy this header and order to a CSV
file and use it for JLCPCB 
manufacturer PCB house.
The multipart components that use
"#" symbol are not allowed by JLCPCB."
  Formula: CONCATENATE(Z16,Z14,Z15)
 Col: AE
  Formula: CONCATENATE(AE14,AE15)
 Col: AJ
  Formula: CONCATENATE(AJ14,AJ15)
 Col: AO
  Formula: CONCATENATE(AO14,AO15)
 Col: AT
  Formula: CONCATENATE(AT14,AT15)
Row: 13
 Col: A
   "*FILTERED*"
Row: 14
 Col: K
  Formula: IF(ISNUMBER(K7:K8)*(K7:K8>0)*(N7:N8<>""),N7:N8&","&TEXT(K7:K8,"##0")&","&SUBSTITUTE(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&A7:A8,",",";")&CHAR(10),"")
 Col: P
  Formula: IF(ISNUMBER(P7:P8)*(P7:P8>0)*(S7:S8<>""),TEXT(P7:P8,"##0")&","&S7:S8&","&SUBSTITUTE(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&A7:A8,",",";")&CHAR(10),"")
 Col: U
  Formula: IF(ISNUMBER(U7:U8)*(U7:U8>0)*(X7:X8<>""),X7:X8&","&TEXT(U7:U8,"##0")&","&LEFT(SUBSTITUTE(SUBSTITUTE(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&C7:C8,",",";"),"\n",";"),30)&","&LEFT(SUBSTITUTE(SUBSTITUTE(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&A7:A8,",",";"),"\n",";"),30)&CHAR(10),"")
 Col: Z
  Formula: IF(ISNUMBER(Z7:Z8)*(Z7:Z8>0)*(AC7:AC8<>""),TEXT(Z7:Z8,"##0")&","&SUBSTITUTE(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&A7:A8,",",";")&","&SUBSTITUTE(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&D7:D8,",",";")&","&AC7:AC8&CHAR(10),"")
 Col: AE
  Formula: IF(ISNUMBER(AE7:AE8)*(AE7:AE8>0)*(AH7:AH8<>""),AH7:AH8&"|"&TEXT(AE7:AE8,"##0")&"|"&SUBSTITUTE(SUBSTITUTE(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&A7:A8,"|",";")," ","_")&CHAR(10),"")
 Col: AJ
  Formula: IF(ISNUMBER(AJ7:AJ8)*(AJ7:AJ8>0)*(AM7:AM8<>""),AM7:AM8&","&TEXT(AJ7:AJ8,"##0")&","&SUBSTITUTE(SUBSTITUTE(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&A7:A8,",",";"),"\n",";")&","&SUBSTITUTE(SUBSTITUTE(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&C7:C8,",",";"),"\n",";")&CHAR(10),"")
 Col: AO
  Formula: IF(ISNUMBER(AO7:AO8)*(AO7:AO8>0)*(AR7:AR8<>""),AR7:AR8&","&TEXT(AO7:AO8,"##0")&","&""&","&""&","&""&","&F7:F8&","&SUBSTITUTE(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&A7:A8,",",";")&CHAR(10),"")
 Col: AT
  Formula: IF(ISNUMBER(AT7:AT8)*(AT7:AT8>0)*(AW7:AW8<>""),AW7:AW8&" "&TEXT(AT7:AT8,"##0")&" "&SUBSTITUTE(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&A7:A8," ",";")&CHAR(10),"")
Row: 15
 Col: K
   0
 Col: P
   0
 Col: U
   0
 Col: Z
   0
 Col: AE
   0
 Col: AJ
   0
 Col: AO
   0
 Col: AT
   0
Row: 16
 Col: Z
  Formula: IFERROR(IF(COUNTIFS(Z7:Z8,">0",AB7:AB8,"<>")>0,"Quantity,Comment,Designator,Footprint,LCSC Part #(optional)"&CHAR(10),""),"")
