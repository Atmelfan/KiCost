Variables:
BoardQty = 'wrong_pricing'!$H$1
Local_part_data = 'wrong_pricing'!$I$5:$M$13
PURCHASE_DESCRIPTION = 'wrong_pricing'!$H$16
TotalCost = 'wrong_pricing'!$H$3
global_part_data = 'wrong_pricing'!$A$5:$H$13
--------------------------------------------------------------------------------
Row: 1
 Col: A
   "Prj:"
 Col: B
   "StickIt-RotaryEncoder Module"
 Col: G
   "Board Qty:"
 Col: H
   100
Row: 2
 Col: A
   "Co.:"
 Col: B
   "XESS Corp."
 Col: G
   "Unit Cost:"
 Col: H
   0
  Formula: TotalCost/BoardQty
Row: 3
 Col: A
   "Prj date:"
 Col: B
   "05/28/2016 12:02:31 AM"
 Col: G
   "Total Cost:"
 Col: H
   0
  Formula: SUM(H7:H13)
 Col: L
   0
  Formula: SUM(L7:L13)
 Col: M
   0
  Formula: (COUNTA(L7:L13)&" of "&ROWS(L7:L13)&" parts found")
Row: 4
 Col: A
   "$ date:"
 Col: B
   *FILTERED*
Row: 5
 Col: A
   "Global Part Info"
 Col: I
   "Local"
Row: 6
 Col: A
   "Refs"
 Col: B
   "Value"
 Col: C
   "Footprint"
 Col: D
   "Manf"
 Col: E
   "Manf#"
 Col: F
   "Qty"
 Col: G
   "Unit$"
 Col: H
   "Ext$"
 Col: I
   "Avail"
 Col: J
   "Purch"
 Col: K
   "Unit$"
 Col: L
   "Ext$"
 Col: M
   "Cat#"
Row: 7
 Col: A
   "C1-C6"
 Col: B
   "C-NONPOL"
 Col: C
   "C_0603_HandSoldering"
 Col: F
   600
  Formula: CEILING(BoardQty*6,1)
 Col: G
   0
  Formula: MINA(INDIRECT(ADDRESS(ROW(),COLUMN(Local_part_data)+2)))
 Col: H
   0
  Formula: iferror(F7*G7,"")
Row: 8
 Col: A
   "JP1-JP4"
 Col: B
   "JUMPER"
 Col: C
   "HDR_1x2"
 Col: F
   400
  Formula: CEILING(BoardQty*4,1)
 Col: G
   0
  Formula: MINA(INDIRECT(ADDRESS(ROW(),COLUMN(Local_part_data)+2)))
 Col: H
   0
  Formula: iferror(F8*G8,"")
Row: 9
 Col: A
   "PCB1"
 Col: B
   "PCB"
 Col: F
   100
  Formula: CEILING(BoardQty*1,1)
 Col: G
   0
  Formula: MINA(INDIRECT(ADDRESS(ROW(),COLUMN(Local_part_data)+2)))
 Col: H
   0
  Formula: iferror(F9*G9,"")
 Col: I
   "NonStk"
 Col: M
   "#ac1c5ddd0f27c7c52daae76efda172d8"
Row: 10
 Col: A1
   "RN1"
 Col: B1
   "4K7"
 Col: C1
   "CTS_742C163"
 Col: D1
   "OMRON"
 Col: E1
   "B3U-1000P"
 Col: F1
   100
  Formula: CEILING(BoardQty*1.0,1)
 Col: G1
   0
  Formula: MINA(INDIRECT(ADDRESS(ROW(),COLUMN(Local_part_data)+2)))
 Col: H1
   0
  Formula: iferror(F10*G10,"")
Row: 11
 Col: A1
   "RN2"
 Col: B1
   "1K"
 Col: C1
   "CTS_742C163"
 Col: F1
   100
  Formula: CEILING(BoardQty*1,1)
 Col: G1
   0
  Formula: MINA(INDIRECT(ADDRESS(ROW(),COLUMN(Local_part_data)+2)))
 Col: H1
   0
  Formula: iferror(F11*G11,"")
Row: 12
 Col: A1
   "ROT1,ROT2"
 Col: B1
   "ROT_ENC_SW"
 Col: C1
   "ROT_ENC_EC11E"
 Col: D1
   "Bourns"
 Col: E1
   "PEC11R-4220F-S0024"
 Col: F1
   200
  Formula: CEILING(BoardQty*2.0,1)
 Col: G1
   0
  Formula: MINA(INDIRECT(ADDRESS(ROW(),COLUMN(Local_part_data)+2)))
 Col: H1
   0
  Formula: iferror(F12*G12,"")
 Col: I1
   "NonStk"
 Col: K1
   0
  Formula: iferror(lookup(if(J12="",F12,J12),{0,1},{0.0,0.372}),"")
 Col: L1
   0
  Formula: iferror(if(J12="",F12,J12)*K12,"")
 Col: M1
   "PEC11R-4220F-S0024"
Row: 13
 Col: A1
   "STK1"
 Col: B1
   "STICKIT2_HDR"
 Col: C1
   "STICKIT2_HDR"
 Col: F1
   100
  Formula: CEILING(BoardQty*1,1)
 Col: G1
   0
  Formula: MINA(INDIRECT(ADDRESS(ROW(),COLUMN(Local_part_data)+2)))
 Col: H1
   0
  Formula: iferror(F13*G13,"")
 Col: I1
   "NonStk"
 Col: M1
   <a href="http://www.aliexpress.com/item/100pcs-lot-2-54mm-Pitch-2-x-40-Pins-Male-Double-Row-Right-Angle-Pin/32356294930.html">#db3cea3d704eea615a6c7a91c62f858c</a>
Row: 15
 Col: G1
   "Total Purchase:"
 Col: H1
   0
  Formula: SUM(INDIRECT(ADDRESS(ROW(),COLUMN(Local_part_data)+3)))
 Col: J1
   0
  Formula: IFERROR(IF(OR(J7:J13),COUNTIFS(J7:J13,">0",L7:L13,"<>")&" of "&(ROWS(L7:L13)-COUNTBLANK(L7:L13))&" parts purchased",""),"")
 Col: L1
   0
  Formula: SUMIF(J7:J13,">0",L7:L13)
Row: 16
 Col: A1
   "*FILTERED*"
 Col: G1
   "Purchase description:"
 Col: J1
   0
  Formula: IFERROR(CONCATENATE(INDEX(M7:M13,SMALL(IF(ISNUMBER(J7:J13),IF(J7:J13>0,IF(M7:M13<>"",ROW(J7:J13)-MIN(ROW(J7:J13))+1))),ROW()-ROW(A$16)+1)),",",TEXT(INDEX(J7:J13,SMALL(IF(ISNUMBER(J7:J13),IF(J7:J13>0,IF(M7:M13<>"",ROW(J7:J13)-MIN(ROW(J7:J13))+1))),ROW()-ROW(A$16)+1)),"##0"),",",SUBSTITUTE(INDEX(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&A7:A13,SMALL(IF(ISNUMBER(J7:J13),IF(J7:J13>0,IF(M7:M13<>"",ROW(J7:J13)-MIN(ROW(J7:J13))+1))),ROW()-ROW(A$16)+1)),",",";")),"")
Row: 17
 Col: J1
   0
  Formula: IFERROR(CONCATENATE(INDEX(M7:M13,SMALL(IF(ISNUMBER(J7:J13),IF(J7:J13>0,IF(M7:M13<>"",ROW(J7:J13)-MIN(ROW(J7:J13))+1))),ROW()-ROW(A$16)+1)),",",TEXT(INDEX(J7:J13,SMALL(IF(ISNUMBER(J7:J13),IF(J7:J13>0,IF(M7:M13<>"",ROW(J7:J13)-MIN(ROW(J7:J13))+1))),ROW()-ROW(A$16)+1)),"##0"),",",SUBSTITUTE(INDEX(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&A7:A13,SMALL(IF(ISNUMBER(J7:J13),IF(J7:J13>0,IF(M7:M13<>"",ROW(J7:J13)-MIN(ROW(J7:J13))+1))),ROW()-ROW(A$16)+1)),",",";")),"")
Row: 18
 Col: J1
   0
  Formula: IFERROR(CONCATENATE(INDEX(M7:M13,SMALL(IF(ISNUMBER(J7:J13),IF(J7:J13>0,IF(M7:M13<>"",ROW(J7:J13)-MIN(ROW(J7:J13))+1))),ROW()-ROW(A$16)+1)),",",TEXT(INDEX(J7:J13,SMALL(IF(ISNUMBER(J7:J13),IF(J7:J13>0,IF(M7:M13<>"",ROW(J7:J13)-MIN(ROW(J7:J13))+1))),ROW()-ROW(A$16)+1)),"##0"),",",SUBSTITUTE(INDEX(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&A7:A13,SMALL(IF(ISNUMBER(J7:J13),IF(J7:J13>0,IF(M7:M13<>"",ROW(J7:J13)-MIN(ROW(J7:J13))+1))),ROW()-ROW(A$16)+1)),",",";")),"")
Row: 19
 Col: J1
   0
  Formula: IFERROR(CONCATENATE(INDEX(M7:M13,SMALL(IF(ISNUMBER(J7:J13),IF(J7:J13>0,IF(M7:M13<>"",ROW(J7:J13)-MIN(ROW(J7:J13))+1))),ROW()-ROW(A$16)+1)),",",TEXT(INDEX(J7:J13,SMALL(IF(ISNUMBER(J7:J13),IF(J7:J13>0,IF(M7:M13<>"",ROW(J7:J13)-MIN(ROW(J7:J13))+1))),ROW()-ROW(A$16)+1)),"##0"),",",SUBSTITUTE(INDEX(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&A7:A13,SMALL(IF(ISNUMBER(J7:J13),IF(J7:J13>0,IF(M7:M13<>"",ROW(J7:J13)-MIN(ROW(J7:J13))+1))),ROW()-ROW(A$16)+1)),",",";")),"")
Row: 20
 Col: J2
   0
  Formula: IFERROR(CONCATENATE(INDEX(M7:M13,SMALL(IF(ISNUMBER(J7:J13),IF(J7:J13>0,IF(M7:M13<>"",ROW(J7:J13)-MIN(ROW(J7:J13))+1))),ROW()-ROW(A$16)+1)),",",TEXT(INDEX(J7:J13,SMALL(IF(ISNUMBER(J7:J13),IF(J7:J13>0,IF(M7:M13<>"",ROW(J7:J13)-MIN(ROW(J7:J13))+1))),ROW()-ROW(A$16)+1)),"##0"),",",SUBSTITUTE(INDEX(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&A7:A13,SMALL(IF(ISNUMBER(J7:J13),IF(J7:J13>0,IF(M7:M13<>"",ROW(J7:J13)-MIN(ROW(J7:J13))+1))),ROW()-ROW(A$16)+1)),",",";")),"")
Row: 21
 Col: J2
   0
  Formula: IFERROR(CONCATENATE(INDEX(M7:M13,SMALL(IF(ISNUMBER(J7:J13),IF(J7:J13>0,IF(M7:M13<>"",ROW(J7:J13)-MIN(ROW(J7:J13))+1))),ROW()-ROW(A$16)+1)),",",TEXT(INDEX(J7:J13,SMALL(IF(ISNUMBER(J7:J13),IF(J7:J13>0,IF(M7:M13<>"",ROW(J7:J13)-MIN(ROW(J7:J13))+1))),ROW()-ROW(A$16)+1)),"##0"),",",SUBSTITUTE(INDEX(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&A7:A13,SMALL(IF(ISNUMBER(J7:J13),IF(J7:J13>0,IF(M7:M13<>"",ROW(J7:J13)-MIN(ROW(J7:J13))+1))),ROW()-ROW(A$16)+1)),",",";")),"")
Row: 22
 Col: J2
   0
  Formula: IFERROR(CONCATENATE(INDEX(M7:M13,SMALL(IF(ISNUMBER(J7:J13),IF(J7:J13>0,IF(M7:M13<>"",ROW(J7:J13)-MIN(ROW(J7:J13))+1))),ROW()-ROW(A$16)+1)),",",TEXT(INDEX(J7:J13,SMALL(IF(ISNUMBER(J7:J13),IF(J7:J13>0,IF(M7:M13<>"",ROW(J7:J13)-MIN(ROW(J7:J13))+1))),ROW()-ROW(A$16)+1)),"##0"),",",SUBSTITUTE(INDEX(IF(PURCHASE_DESCRIPTION<>"",PURCHASE_DESCRIPTION&":","")&A7:A13,SMALL(IF(ISNUMBER(J7:J13),IF(J7:J13>0,IF(M7:M13<>"",ROW(J7:J13)-MIN(ROW(J7:J13))+1))),ROW()-ROW(A$16)+1)),",",";")),"")
