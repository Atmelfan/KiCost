Variables:
BoardQty = 'kc-test'!$G$1
PURCH_DESC = 'kc-test'!$G$13
TotalCost = 'kc-test'!$G$3
USD_EUR = 'kc-test'!$C$13
USD_GBP = 'kc-test'!$C$14
arrow_part_data = 'kc-test'!$H$5:$L$10
digikey_part_data = 'kc-test'!$M$5:$Q$10
farnell_part_data = 'kc-test'!$R$5:$V$10
global_part_data = 'kc-test'!$A$5:$G$10
lcsc_part_data = 'kc-test'!$W$5:$AA$10
mouser_part_data = 'kc-test'!$AB$5:$AF$10
newark_part_data = 'kc-test'!$AG$5:$AK$10
rs_part_data = 'kc-test'!$AL$5:$AP$10
tme_part_data = 'kc-test'!$AQ$5:$AU$10
--------------------------------------------------------------------------------
Row: 1
 Col: A
   "Prj:"
 Col: B
   "kc-test.xml"
 Col: F
   "Board Qty:"
 Col: G
   100
Row: 2
 Col: A
   "Co.:"
 Col: F
   "Unit Cost:"
 Col: G
   0
  Formula: TotalCost/BoardQty
Row: 3
 Col: A
   "Prj date:"
 Col: B
   "04/21/2017 4:03:40 PM"
 Col: F
   "Total Cost:"
 Col: G
   0
  Formula: SUM(G7:G10)
 Col: K
   0
  Formula: SUM(K7:K10)
 Col: L
   0
  Formula: (COUNTA(K7:K10)&" of "&ROWS(K7:K10)&" parts found")
 Col: P
   0
  Formula: SUM(P7:P10)
 Col: Q
   0
  Formula: (COUNTA(P7:P10)&" of "&ROWS(P7:P10)&" parts found")
 Col: U
   0
  Formula: SUM(U7:U10)
 Col: V
   0
  Formula: (COUNTA(U7:U10)&" of "&ROWS(U7:U10)&" parts found")
 Col: Z
   0
  Formula: SUM(Z7:Z10)
 Col: AA
   0
  Formula: (COUNTA(Z7:Z10)&" of "&ROWS(Z7:Z10)&" parts found")
 Col: AE
   0
  Formula: SUM(AE7:AE10)
 Col: AF
   0
  Formula: (COUNTA(AE7:AE10)&" of "&ROWS(AE7:AE10)&" parts found")
 Col: AJ
   0
  Formula: SUM(AJ7:AJ10)
 Col: AK
   0
  Formula: (COUNTA(AJ7:AJ10)&" of "&ROWS(AJ7:AJ10)&" parts found")
 Col: AO
   0
  Formula: SUM(AO7:AO10)
 Col: AP
   0
  Formula: (COUNTA(AO7:AO10)&" of "&ROWS(AO7:AO10)&" parts found")
 Col: AT
   0
  Formula: SUM(AT7:AT10)
 Col: AU
   0
  Formula: (COUNTA(AT7:AT10)&" of "&ROWS(AT7:AT10)&" parts found")
Row: 4
 Col: A
   "$ date:"
 Col: B
   *FILTERED*
Row: 5
 Col: A
   "Global Part Info"
 Col: H
   "Arrow"
 Col: M
   "Digi-Key"
 Col: R
   "Farnell"
 Col: W
   "LCSC"
 Col: AB
   "Mouser"
 Col: AG
   "Newark"
 Col: AL
   "RS Components"
 Col: AQ
   "TME"
Row: 6
 Col: A
   "Refs"
 Col: B
   "Value"
 Col: C
   "Footprint"
 Col: D
   "Manf#"
 Col: E
   "Qty"
 Col: F
   "Unit$"
 Col: G
   "Ext$"
 Col: H
   "Avail"
 Col: I
   "Purch"
 Col: J
   "Unit$"
 Col: K
   "Ext$"
 Col: L
   "Cat#"
 Col: M
   "Avail"
 Col: N
   "Purch"
 Col: O
   "Unit$"
 Col: P
   "Ext$"
 Col: Q
   "Cat#"
 Col: R
   "Avail"
 Col: S
   "Purch"
 Col: T
   "Unit$"
 Col: U
   "Ext$"
 Col: V
   "Cat#"
 Col: W
   "Avail"
 Col: X
   "Purch"
 Col: Y
   "Unit$"
 Col: Z
   "Ext$"
 Col: AA
   "Cat#"
 Col: AB
   "Avail"
 Col: AC
   "Purch"
 Col: AD
   "Unit$"
 Col: AE
   "Ext$"
 Col: AF
   "Cat#"
 Col: AG
   "Avail"
 Col: AH
   "Purch"
 Col: AI
   "Unit$"
 Col: AJ
   "Ext$"
 Col: AK
   "Cat#"
 Col: AL
   "Avail"
 Col: AM
   "Purch"
 Col: AN
   "Unit$"
 Col: AO
   "Ext$"
 Col: AP
   "Cat#"
 Col: AQ
   "Avail"
 Col: AR
   "Purch"
 Col: AS
   "Unit$"
 Col: AT
   "Ext$"
 Col: AU
   "Cat#"
Row: 7
 Col: A
   "U1"
 Col: B
   "MCP4822"
 Col: D
   <a href="http://datasheet.octopart.com/MCP4822-E/SN-Microchip-datasheet-8699770.pdf">MCP4822-E/SN</a>
 Col: E
   100
  Formula: CEILING(BoardQty*1.0,1)
 Col: F
   0
  Formula: MINA(J7,O7,T7,Y7,AD7,AI7,AN7,AS7)
 Col: G
   0
  Formula: iferror(E7*F7,"")
 Col: M
   4622
 Col: O
   0
  Formula: iferror(lookup(if(N7="",E7,N7),{0,1,25,100},{0.0,3.15,2.63,2.38}),"")
 Col: P
   0
  Formula: iferror(if(N7="",E7,N7)*O7,"")
 Col: Q
   <a href="https://octopart.com/click/track?ai=8078&sig=00138f8&sid=459&ppid=438323&vpid=2044679&ct=offers">MCP4822-E/SN-ND</a>
 Col: R
   6489
 Col: T
   0
  Formula: iferror(USD_GBP*lookup(if(S7="",E7,S7),{0,1,25,100},{0.0,2.9,2.43,2.19}),"")
 Col: U
   0
  Formula: iferror(if(S7="",E7,S7)*T7,"")
 Col: V
   <a href="https://octopart.com/click/track?ai=8078&sig=09893a7&sid=819&ppid=438323&vpid=139007676&ct=offers">1439414</a>
 Col: W
   223
 Col: Y
   0
  Formula: iferror(lookup(if(X7="",E7,X7),{0,1,10,30,100,500,1000},{0.0,3.0223,2.2956,2.1622,2.0287,1.971,1.9404}),"")
 Col: Z
   0
  Formula: iferror(if(X7="",E7,X7)*Y7,"")
 Col: AA
   <a href="https://octopart.com/click/track?ai=8078&sig=0d6ec5b&sid=27971&ppid=438323&vpid=445983371&ct=offers">C16040</a>
 Col: AB
   4335
 Col: AD
   0
  Formula: iferror(lookup(if(AC7="",E7,AC7),{0,1,10,50,100,1000,10000},{0.0,3.15,3.15,2.63,2.38,2.38,2.38}),"")
 Col: AE
   0
  Formula: iferror(if(AC7="",E7,AC7)*AD7,"")
 Col: AF
   <a href="https://octopart.com/click/track?ai=8078&sig=0de565b&sid=2401&ppid=438323&vpid=37645679&ct=offers">579MCP4822E/SN</a>
 Col: AG
   3709
 Col: AI
   0
  Formula: iferror(lookup(if(AH7="",E7,AH7),{0,1,10,25,50,100,200},{0.0,3.15,2.89,2.63,2.51,2.38,2.74}),"")
 Col: AJ
   0
  Formula: iferror(if(AH7="",E7,AH7)*AI7,"")
 Col: AK
   <a href="https://octopart.com/click/track?ai=8078&sig=00461dd&sid=2402&ppid=438323&vpid=11881703&ct=offers">58M8927</a>
 Col: AL
   1674
 Col: AN
   0
  Formula: iferror(USD_GBP*lookup(if(AM7="",E7,AM7),{0,1,2,10,24,100},{0.0,2.405,2.405,2.075,1.93,1.785}),"")
 Col: AO
   0
  Formula: iferror(if(AM7="",E7,AM7)*AN7,"")
 Col: AP
   <a href="https://octopart.com/click/track?ai=8078&sig=0f8ba8d&sid=10022&ppid=438323&vpid=199061725&ct=offers">6696304</a>
 Col: AQ
   1
 Col: AS
   0
  Formula: iferror(USD_EUR*lookup(if(AR7="",E7,AR7),{0,1,5,25,100},{0.0,2.19,2.08,1.82,1.68}),"")
 Col: AT
   0
  Formula: iferror(if(AR7="",E7,AR7)*AS7,"")
 Col: AU
   <a href="https://octopart.com/click/track?ai=8078&sig=00e1d78&sid=1532&ppid=438323&vpid=709082115&ct=offers">MCP4822E/SN</a>
Row: 8
 Col: A
   "U2"
 Col: B
   "OPA2347"
 Col: D
   <a href="https://octopart.com/click/track?ai=8078&ct=datasheets&sig=08d6160&at=physicalpart&sid=370&ppid=420474&hlid=30050212">OPA2347EA/250</a>
 Col: E
   100
  Formula: CEILING(BoardQty*1.0,1)
 Col: F
   0
  Formula: MINA(J8,O8,T8,Y8,AD8,AI8,AN8,AS8)
 Col: G
   0
  Formula: iferror(E8*F8,"")
 Col: M
   1950
 Col: O
   0
  Formula: iferror(lookup(if(N8="",E8,N8),{0,1,10,25,100,250,500,1000},{0.0,1.41,1.263,1.1992,0.985,0.92072,0.81366,0.67468}),"")
 Col: P
   0
  Formula: iferror(if(N8="",E8,N8)*O8,"")
 Col: Q
   <a href="https://octopart.com/click/track?ai=8078&sig=0640b59&sid=459&ppid=420474&vpid=275799955&ct=offers">296-44981-1-ND</a>
 Col: AB
   366
 Col: AD
   0
  Formula: iferror(lookup(if(AC8="",E8,AC8),{0,1,10,50,100,1000,10000},{0.0,1.4,1.27,1.27,0.921,0.599,0.545}),"")
 Col: AE
   0
  Formula: iferror(if(AC8="",E8,AC8)*AD8,"")
 Col: AF
   <a href="https://octopart.com/click/track?ai=8078&sig=0d3fc87&sid=2401&ppid=420474&vpid=37769947&ct=offers">595OPA2347EA/250</a>
Row: 9
 Col: A
   "U3"
 Col: B
   "ADM3053"
 Col: D
   <a href="http://datasheet.octopart.com/ADM3053BRWZ-Analog-Devices-datasheet-14540930.pdf">ADM3053BRWZ</a>
 Col: E
   100
  Formula: CEILING(BoardQty*1.0,1)
 Col: F
   0
  Formula: MINA(J9,O9,T9,Y9,AD9,AI9,AN9,AS9)
 Col: G
   0
  Formula: iferror(E9*F9,"")
 Col: M
   "NonStk"
 Col: O
   0
  Formula: iferror(lookup(if(N9="",E9,N9),{0,1,10,25,100,250,500,1000},{0.0,12.53,11.518,11.0404,9.7275,9.25008,8.65332,8.445}),"")
 Col: P
   0
  Formula: iferror(if(N9="",E9,N9)*O9,"")
 Col: Q
   <a href="https://octopart.com/click/track?c=1&ai=8078&sig=0a959d5&sid=459&ppid=18901679&vpid=39491825&ct=offers">ADM3053BRWZ-ND</a>
 Col: R
   "NonStk"
 Col: T
   0
  Formula: iferror(USD_GBP*lookup(if(S9="",E9,S9),{0,1,10,25,50,100,250},{0.0,10.1,8.76,8.4,8.16,7.04,6.58}),"")
 Col: U
   0
  Formula: iferror(if(S9="",E9,S9)*T9,"")
 Col: V
   <a href="https://octopart.com/click/track?c=1&ai=8078&sig=0390e18&sid=819&ppid=18901679&vpid=138563883&ct=offers">2062027</a>
 Col: AB
   "NonStk"
 Col: AD
   0
  Formula: iferror(lookup(if(AC9="",E9,AC9),{0,1,10,50,100,1000,10000},{0.0,11.82,10.86,10.11,8.72,8.16,8.16}),"")
 Col: AE
   0
  Formula: iferror(if(AC9="",E9,AC9)*AD9,"")
 Col: AF
   <a href="https://octopart.com/click/track?c=1&ai=8078&sig=0e12eb4&sid=2401&ppid=18901679&vpid=82534459&ct=offers">584ADM3053BRWZ</a>
 Col: AL
   296
 Col: AN
   0
  Formula: iferror(USD_GBP*lookup(if(AM9="",E9,AM9),{0,1,37},{0.0,8.92,7.861}),"")
 Col: AO
   0
  Formula: iferror(if(AM9="",E9,AM9)*AN9,"")
 Col: AP
   <a href="https://octopart.com/click/track?ai=8078&sig=05a8713&sid=10022&ppid=18901679&vpid=448603363&ct=offers">7427809P</a>
 Col: AQ
   "NonStk"
 Col: AS
   0
  Formula: iferror(USD_EUR*lookup(if(AR9="",E9,AR9),{0,1,3,10,37},{0.0,9.83,8.67,7.79,7.28}),"")
 Col: AT
   0
  Formula: iferror(if(AR9="",E9,AR9)*AS9,"")
 Col: AU
   <a href="https://octopart.com/click/track?ai=8078&sig=0326bce&sid=1532&ppid=18901679&vpid=707783969&ct=offers">ADM3053BRWZ</a>
Row: 10
 Col: A1
   "X1"
 Col: B1
   "RESONATOR"
 Col: D1
   <a href="http://datasheet.octopart.com/CSTCE8M00G55Z-R0-Murata-datasheet-141258351.pdf">CSTCE8M00G55Z-R0</a>
 Col: E1
   100
  Formula: CEILING(BoardQty*1.0,1)
 Col: F1
   0
  Formula: MINA(J10,O10,T10,Y10,AD10,AI10,AN10,AS10)
 Col: G1
   0
  Formula: iferror(E10*F10,"")
 Col: R1
   "NonStk"
 Col: T1
   0
  Formula: iferror(USD_GBP*lookup(if(S10="",E10,S10),{0,1,5,50,150,250,500,1500,3000,15000},{0.0,0.376,0.376,0.284,0.284,0.258,0.211,0.199,0.186,0.182}),"")
 Col: U1
   0
  Formula: iferror(if(S10="",E10,S10)*T10,"")
 Col: V1
   <a href="https://octopart.com/click/track?c=1&ai=8078&sig=057eeca&sid=819&ppid=314394&vpid=139132810&ct=offers">1615352</a>
 Col: AG1
   "NonStk"
 Col: AK1
   <a href="https://octopart.com/click/track?c=1&ai=8078&sig=070c3ef&sid=2402&ppid=314394&vpid=17276023&ct=offers">80P4001</a>
Row: 12
 Col: B1
   "Used currency rates:"
 Col: F1
   "Total Purchase:"
 Col: G1
   0
  Formula: SUM(K12,P12,U12,Z12,AE12,AJ12,AO12,AT12)
 Col: H1
   <a href="https://www.arrow.com/en/bom-tool/">Buy here</a>
 Col: I1
   0
  Formula: IFERROR(IF(OR(I7:I10),COUNTIFS(I7:I10,">0",K7:K10,"<>")&" of "&(ROWS(K7:K10)-COUNTBLANK(K7:K10))&" parts purchased",""),"")
 Col: K1
   0
  Formula: SUMIF(I7:I10,">0",K7:K10)
 Col: M1
   <a href="https://www.digikey.com/ordering/shoppingcart">Buy here</a>
 Col: N1
   0
  Formula: IFERROR(IF(OR(N7:N10),COUNTIFS(N7:N10,">0",P7:P10,"<>")&" of "&(ROWS(P7:P10)-COUNTBLANK(P7:P10))&" parts purchased",""),"")
 Col: P1
   0
  Formula: SUMIF(N7:N10,">0",P7:P10)
 Col: R1
   <a href="https://fr.farnell.com/en-FR/quick-order?isQuickPaste=true">Buy here</a>
 Col: S1
   0
  Formula: IFERROR(IF(OR(S7:S10),COUNTIFS(S7:S10,">0",U7:U10,"<>")&" of "&(ROWS(U7:U10)-COUNTBLANK(U7:U10))&" parts purchased",""),"")
 Col: U1
   0
  Formula: SUMIF(S7:S10,">0",U7:U10)
 Col: W1
   <a href="https://lcsc.com/bom.html">Buy here</a>
 Col: X1
   0
  Formula: IFERROR(IF(OR(X7:X10),COUNTIFS(X7:X10,">0",Z7:Z10,"<>")&" of "&(ROWS(Z7:Z10)-COUNTBLANK(Z7:Z10))&" parts purchased",""),"")
 Col: Z1
   0
  Formula: SUMIF(X7:X10,">0",Z7:Z10)
 Col: AB1
   <a href="https://mouser.com/bom/">Buy here</a>
 Col: AC1
   0
  Formula: IFERROR(IF(OR(AC7:AC10),COUNTIFS(AC7:AC10,">0",AE7:AE10,"<>")&" of "&(ROWS(AE7:AE10)-COUNTBLANK(AE7:AE10))&" parts purchased",""),"")
 Col: AE1
   0
  Formula: SUMIF(AC7:AC10,">0",AE7:AE10)
 Col: AG1
   <a href="https://www.newark.com/quick-order?isQuickPaste=true">Buy here</a>
 Col: AH1
   0
  Formula: IFERROR(IF(OR(AH7:AH10),COUNTIFS(AH7:AH10,">0",AJ7:AJ10,"<>")&" of "&(ROWS(AJ7:AJ10)-COUNTBLANK(AJ7:AJ10))&" parts purchased",""),"")
 Col: AJ1
   0
  Formula: SUMIF(AH7:AH10,">0",AJ7:AJ10)
 Col: AL1
   <a href="https://uk.rs-online.com/web/mylists/manualQuotes.html?method=showEnquiryCreationPage&mode=new">Buy here</a>
 Col: AM1
   0
  Formula: IFERROR(IF(OR(AM7:AM10),COUNTIFS(AM7:AM10,">0",AO7:AO10,"<>")&" of "&(ROWS(AO7:AO10)-COUNTBLANK(AO7:AO10))&" parts purchased",""),"")
 Col: AO1
   0
  Formula: SUMIF(AM7:AM10,">0",AO7:AO10)
 Col: AQ1
   <a href="https://www.tme.eu/en/Profile/QuickBuy/load.html">Buy here</a>
 Col: AR1
   0
  Formula: IFERROR(IF(OR(AR7:AR10),COUNTIFS(AR7:AR10,">0",AT7:AT10,"<>")&" of "&(ROWS(AT7:AT10)-COUNTBLANK(AT7:AT10))&" parts purchased",""),"")
 Col: AT1
   0
  Formula: SUMIF(AR7:AR10,">0",AT7:AT10)
Row: 13
 Col: B1
   "USD($)/EUR(€):"
 Col: C1
   1.1873
 Col: F1
   "Purchase description:"
 Col: I1
   0
  Formula: IFERROR(CONCATENATE(INDEX(L7:L10,SMALL(IF(ISNUMBER(I7:I10)*(I7:I10>0)*(L7:L10<>""),ROW(A1:A4)),ROW()-12)),",",TEXT(INDEX(I7:I10,SMALL(IF(ISNUMBER(I7:I10)*(I7:I10>0)*(L7:L10<>""),ROW(A1:A4)),ROW()-12)),"##0"),",",SUBSTITUTE(INDEX(IF(PURCH_DESC<>"",PURCH_DESC&":","")&A7:A10,SMALL(IF(ISNUMBER(I7:I10)*(I7:I10>0)*(L7:L10<>""),ROW(A1:A4)),ROW()-12)),",",";")),"")
 Col: N1
   0
  Formula: IFERROR(CONCATENATE(TEXT(INDEX(N7:N10,SMALL(IF(ISNUMBER(N7:N10)*(N7:N10>0)*(Q7:Q10<>""),ROW(A1:A4)),ROW()-12)),"##0"),",",INDEX(Q7:Q10,SMALL(IF(ISNUMBER(N7:N10)*(N7:N10>0)*(Q7:Q10<>""),ROW(A1:A4)),ROW()-12)),",",SUBSTITUTE(INDEX(IF(PURCH_DESC<>"",PURCH_DESC&":","")&A7:A10,SMALL(IF(ISNUMBER(N7:N10)*(N7:N10>0)*(Q7:Q10<>""),ROW(A1:A4)),ROW()-12)),",",";")),"")
 Col: S1
   0
  Formula: IFERROR(CONCATENATE(INDEX(V7:V10,SMALL(IF(ISNUMBER(S7:S10)*(S7:S10>0)*(V7:V10<>""),ROW(A1:A4)),ROW()-12)),",",TEXT(INDEX(S7:S10,SMALL(IF(ISNUMBER(S7:S10)*(S7:S10>0)*(V7:V10<>""),ROW(A1:A4)),ROW()-12)),"##0"),",",,",",LEFT(SUBSTITUTE(SUBSTITUTE(INDEX(IF(PURCH_DESC<>"",PURCH_DESC&":","")&A7:A10,SMALL(IF(ISNUMBER(S7:S10)*(S7:S10>0)*(V7:V10<>""),ROW(A1:A4)),ROW()-12)),",",";"),"\n",";"),30)),"")
 Col: X1
   0
  Formula: IFERROR(IF(COUNTIFS(X7:X10,">0",Z7:Z10,"<>")>0,"Quantity,Comment,Designator,Footprint,LCSC Part #(optional)",""),"")
 Col: AC1
   0
  Formula: IFERROR(CONCATENATE(INDEX(AF7:AF10,SMALL(IF(ISNUMBER(AC7:AC10)*(AC7:AC10>0)*(AF7:AF10<>""),ROW(A1:A4)),ROW()-12)),"|",TEXT(INDEX(AC7:AC10,SMALL(IF(ISNUMBER(AC7:AC10)*(AC7:AC10>0)*(AF7:AF10<>""),ROW(A1:A4)),ROW()-12)),"##0"),"|",SUBSTITUTE(SUBSTITUTE(INDEX(IF(PURCH_DESC<>"",PURCH_DESC&":","")&A7:A10,SMALL(IF(ISNUMBER(AC7:AC10)*(AC7:AC10>0)*(AF7:AF10<>""),ROW(A1:A4)),ROW()-12)),"|",";")," ","_")),"")
 Col: AH1
   0
  Formula: IFERROR(CONCATENATE(INDEX(AK7:AK10,SMALL(IF(ISNUMBER(AH7:AH10)*(AH7:AH10>0)*(AK7:AK10<>""),ROW(A1:A4)),ROW()-12)),",",TEXT(INDEX(AH7:AH10,SMALL(IF(ISNUMBER(AH7:AH10)*(AH7:AH10>0)*(AK7:AK10<>""),ROW(A1:A4)),ROW()-12)),"##0"),",",SUBSTITUTE(SUBSTITUTE(INDEX(IF(PURCH_DESC<>"",PURCH_DESC&":","")&A7:A10,SMALL(IF(ISNUMBER(AH7:AH10)*(AH7:AH10>0)*(AK7:AK10<>""),ROW(A1:A4)),ROW()-12)),",",";"),"\n",";"),",",),"")
 Col: AM1
   0
  Formula: IFERROR(CONCATENATE(INDEX(AP7:AP10,SMALL(IF(ISNUMBER(AM7:AM10)*(AM7:AM10>0)*(AP7:AP10<>""),ROW(A1:A4)),ROW()-12)),",",TEXT(INDEX(AM7:AM10,SMALL(IF(ISNUMBER(AM7:AM10)*(AM7:AM10>0)*(AP7:AP10<>""),ROW(A1:A4)),ROW()-12)),"##0"),",",,",",,",",,",",INDEX(D7:D10,SMALL(IF(ISNUMBER(AM7:AM10)*(AM7:AM10>0)*(AP7:AP10<>""),ROW(A1:A4)),ROW()-12)),",",SUBSTITUTE(INDEX(IF(PURCH_DESC<>"",PURCH_DESC&":","")&A7:A10,SMALL(IF(ISNUMBER(AM7:AM10)*(AM7:AM10>0)*(AP7:AP10<>""),ROW(A1:A4)),ROW()-12)),",",";")),"")
 Col: AR1
   0
  Formula: IFERROR(CONCATENATE(INDEX(AU7:AU10,SMALL(IF(ISNUMBER(AR7:AR10)*(AR7:AR10>0)*(AU7:AU10<>""),ROW(A1:A4)),ROW()-12))," ",TEXT(INDEX(AR7:AR10,SMALL(IF(ISNUMBER(AR7:AR10)*(AR7:AR10>0)*(AU7:AU10<>""),ROW(A1:A4)),ROW()-12)),"##0")," ",SUBSTITUTE(INDEX(IF(PURCH_DESC<>"",PURCH_DESC&":","")&A7:A10,SMALL(IF(ISNUMBER(AR7:AR10)*(AR7:AR10>0)*(AU7:AU10<>""),ROW(A1:A4)),ROW()-12))," ",";")),"")
Row: 14
 Col: B1
   "USD($)/GBP(£):"
 Col: C1
   1.375941592305018
 Col: I1
   0
  Formula: IFERROR(CONCATENATE(INDEX(L7:L10,SMALL(IF(ISNUMBER(I7:I10)*(I7:I10>0)*(L7:L10<>""),ROW(A1:A4)),ROW()-12)),",",TEXT(INDEX(I7:I10,SMALL(IF(ISNUMBER(I7:I10)*(I7:I10>0)*(L7:L10<>""),ROW(A1:A4)),ROW()-12)),"##0"),",",SUBSTITUTE(INDEX(IF(PURCH_DESC<>"",PURCH_DESC&":","")&A7:A10,SMALL(IF(ISNUMBER(I7:I10)*(I7:I10>0)*(L7:L10<>""),ROW(A1:A4)),ROW()-12)),",",";")),"")
 Col: N1
   0
  Formula: IFERROR(CONCATENATE(TEXT(INDEX(N7:N10,SMALL(IF(ISNUMBER(N7:N10)*(N7:N10>0)*(Q7:Q10<>""),ROW(A1:A4)),ROW()-12)),"##0"),",",INDEX(Q7:Q10,SMALL(IF(ISNUMBER(N7:N10)*(N7:N10>0)*(Q7:Q10<>""),ROW(A1:A4)),ROW()-12)),",",SUBSTITUTE(INDEX(IF(PURCH_DESC<>"",PURCH_DESC&":","")&A7:A10,SMALL(IF(ISNUMBER(N7:N10)*(N7:N10>0)*(Q7:Q10<>""),ROW(A1:A4)),ROW()-12)),",",";")),"")
 Col: S1
   0
  Formula: IFERROR(CONCATENATE(INDEX(V7:V10,SMALL(IF(ISNUMBER(S7:S10)*(S7:S10>0)*(V7:V10<>""),ROW(A1:A4)),ROW()-12)),",",TEXT(INDEX(S7:S10,SMALL(IF(ISNUMBER(S7:S10)*(S7:S10>0)*(V7:V10<>""),ROW(A1:A4)),ROW()-12)),"##0"),",",,",",LEFT(SUBSTITUTE(SUBSTITUTE(INDEX(IF(PURCH_DESC<>"",PURCH_DESC&":","")&A7:A10,SMALL(IF(ISNUMBER(S7:S10)*(S7:S10>0)*(V7:V10<>""),ROW(A1:A4)),ROW()-12)),",",";"),"\n",";"),30)),"")
 Col: X1
   0
  Formula: IFERROR(CONCATENATE(TEXT(INDEX(X7:X10,SMALL(IF(ISNUMBER(X7:X10)*(X7:X10>0)*(AA7:AA10<>""),ROW(A1:A4)),ROW()-13)),"##0"),",",SUBSTITUTE(INDEX(IF(PURCH_DESC<>"",PURCH_DESC&":","")&A7:A10,SMALL(IF(ISNUMBER(X7:X10)*(X7:X10>0)*(AA7:AA10<>""),ROW(A1:A4)),ROW()-13)),",",";"),",",SUBSTITUTE(INDEX(IF(PURCH_DESC<>"",PURCH_DESC&":","")&C7:C10,SMALL(IF(ISNUMBER(X7:X10)*(X7:X10>0)*(AA7:AA10<>""),ROW(A1:A4)),ROW()-13)),",",";"),",",INDEX(AA7:AA10,SMALL(IF(ISNUMBER(X7:X10)*(X7:X10>0)*(AA7:AA10<>""),ROW(A1:A4)),ROW()-13))),"")
 Col: AC1
   0
  Formula: IFERROR(CONCATENATE(INDEX(AF7:AF10,SMALL(IF(ISNUMBER(AC7:AC10)*(AC7:AC10>0)*(AF7:AF10<>""),ROW(A1:A4)),ROW()-12)),"|",TEXT(INDEX(AC7:AC10,SMALL(IF(ISNUMBER(AC7:AC10)*(AC7:AC10>0)*(AF7:AF10<>""),ROW(A1:A4)),ROW()-12)),"##0"),"|",SUBSTITUTE(SUBSTITUTE(INDEX(IF(PURCH_DESC<>"",PURCH_DESC&":","")&A7:A10,SMALL(IF(ISNUMBER(AC7:AC10)*(AC7:AC10>0)*(AF7:AF10<>""),ROW(A1:A4)),ROW()-12)),"|",";")," ","_")),"")
 Col: AH1
   0
  Formula: IFERROR(CONCATENATE(INDEX(AK7:AK10,SMALL(IF(ISNUMBER(AH7:AH10)*(AH7:AH10>0)*(AK7:AK10<>""),ROW(A1:A4)),ROW()-12)),",",TEXT(INDEX(AH7:AH10,SMALL(IF(ISNUMBER(AH7:AH10)*(AH7:AH10>0)*(AK7:AK10<>""),ROW(A1:A4)),ROW()-12)),"##0"),",",SUBSTITUTE(SUBSTITUTE(INDEX(IF(PURCH_DESC<>"",PURCH_DESC&":","")&A7:A10,SMALL(IF(ISNUMBER(AH7:AH10)*(AH7:AH10>0)*(AK7:AK10<>""),ROW(A1:A4)),ROW()-12)),",",";"),"\n",";"),",",),"")
 Col: AM1
   0
  Formula: IFERROR(CONCATENATE(INDEX(AP7:AP10,SMALL(IF(ISNUMBER(AM7:AM10)*(AM7:AM10>0)*(AP7:AP10<>""),ROW(A1:A4)),ROW()-12)),",",TEXT(INDEX(AM7:AM10,SMALL(IF(ISNUMBER(AM7:AM10)*(AM7:AM10>0)*(AP7:AP10<>""),ROW(A1:A4)),ROW()-12)),"##0"),",",,",",,",",,",",INDEX(D7:D10,SMALL(IF(ISNUMBER(AM7:AM10)*(AM7:AM10>0)*(AP7:AP10<>""),ROW(A1:A4)),ROW()-12)),",",SUBSTITUTE(INDEX(IF(PURCH_DESC<>"",PURCH_DESC&":","")&A7:A10,SMALL(IF(ISNUMBER(AM7:AM10)*(AM7:AM10>0)*(AP7:AP10<>""),ROW(A1:A4)),ROW()-12)),",",";")),"")
 Col: AR1
   0
  Formula: IFERROR(CONCATENATE(INDEX(AU7:AU10,SMALL(IF(ISNUMBER(AR7:AR10)*(AR7:AR10>0)*(AU7:AU10<>""),ROW(A1:A4)),ROW()-12))," ",TEXT(INDEX(AR7:AR10,SMALL(IF(ISNUMBER(AR7:AR10)*(AR7:AR10>0)*(AU7:AU10<>""),ROW(A1:A4)),ROW()-12)),"##0")," ",SUBSTITUTE(INDEX(IF(PURCH_DESC<>"",PURCH_DESC&":","")&A7:A10,SMALL(IF(ISNUMBER(AR7:AR10)*(AR7:AR10>0)*(AU7:AU10<>""),ROW(A1:A4)),ROW()-12))," ",";")),"")
Row: 15
 Col: I1
   0
  Formula: IFERROR(CONCATENATE(INDEX(L7:L10,SMALL(IF(ISNUMBER(I7:I10)*(I7:I10>0)*(L7:L10<>""),ROW(A1:A4)),ROW()-12)),",",TEXT(INDEX(I7:I10,SMALL(IF(ISNUMBER(I7:I10)*(I7:I10>0)*(L7:L10<>""),ROW(A1:A4)),ROW()-12)),"##0"),",",SUBSTITUTE(INDEX(IF(PURCH_DESC<>"",PURCH_DESC&":","")&A7:A10,SMALL(IF(ISNUMBER(I7:I10)*(I7:I10>0)*(L7:L10<>""),ROW(A1:A4)),ROW()-12)),",",";")),"")
 Col: N1
   0
  Formula: IFERROR(CONCATENATE(TEXT(INDEX(N7:N10,SMALL(IF(ISNUMBER(N7:N10)*(N7:N10>0)*(Q7:Q10<>""),ROW(A1:A4)),ROW()-12)),"##0"),",",INDEX(Q7:Q10,SMALL(IF(ISNUMBER(N7:N10)*(N7:N10>0)*(Q7:Q10<>""),ROW(A1:A4)),ROW()-12)),",",SUBSTITUTE(INDEX(IF(PURCH_DESC<>"",PURCH_DESC&":","")&A7:A10,SMALL(IF(ISNUMBER(N7:N10)*(N7:N10>0)*(Q7:Q10<>""),ROW(A1:A4)),ROW()-12)),",",";")),"")
 Col: S1
   0
  Formula: IFERROR(CONCATENATE(INDEX(V7:V10,SMALL(IF(ISNUMBER(S7:S10)*(S7:S10>0)*(V7:V10<>""),ROW(A1:A4)),ROW()-12)),",",TEXT(INDEX(S7:S10,SMALL(IF(ISNUMBER(S7:S10)*(S7:S10>0)*(V7:V10<>""),ROW(A1:A4)),ROW()-12)),"##0"),",",,",",LEFT(SUBSTITUTE(SUBSTITUTE(INDEX(IF(PURCH_DESC<>"",PURCH_DESC&":","")&A7:A10,SMALL(IF(ISNUMBER(S7:S10)*(S7:S10>0)*(V7:V10<>""),ROW(A1:A4)),ROW()-12)),",",";"),"\n",";"),30)),"")
 Col: X1
   0
  Formula: IFERROR(CONCATENATE(TEXT(INDEX(X7:X10,SMALL(IF(ISNUMBER(X7:X10)*(X7:X10>0)*(AA7:AA10<>""),ROW(A1:A4)),ROW()-13)),"##0"),",",SUBSTITUTE(INDEX(IF(PURCH_DESC<>"",PURCH_DESC&":","")&A7:A10,SMALL(IF(ISNUMBER(X7:X10)*(X7:X10>0)*(AA7:AA10<>""),ROW(A1:A4)),ROW()-13)),",",";"),",",SUBSTITUTE(INDEX(IF(PURCH_DESC<>"",PURCH_DESC&":","")&C7:C10,SMALL(IF(ISNUMBER(X7:X10)*(X7:X10>0)*(AA7:AA10<>""),ROW(A1:A4)),ROW()-13)),",",";"),",",INDEX(AA7:AA10,SMALL(IF(ISNUMBER(X7:X10)*(X7:X10>0)*(AA7:AA10<>""),ROW(A1:A4)),ROW()-13))),"")
 Col: AC1
   0
  Formula: IFERROR(CONCATENATE(INDEX(AF7:AF10,SMALL(IF(ISNUMBER(AC7:AC10)*(AC7:AC10>0)*(AF7:AF10<>""),ROW(A1:A4)),ROW()-12)),"|",TEXT(INDEX(AC7:AC10,SMALL(IF(ISNUMBER(AC7:AC10)*(AC7:AC10>0)*(AF7:AF10<>""),ROW(A1:A4)),ROW()-12)),"##0"),"|",SUBSTITUTE(SUBSTITUTE(INDEX(IF(PURCH_DESC<>"",PURCH_DESC&":","")&A7:A10,SMALL(IF(ISNUMBER(AC7:AC10)*(AC7:AC10>0)*(AF7:AF10<>""),ROW(A1:A4)),ROW()-12)),"|",";")," ","_")),"")
 Col: AH1
   0
  Formula: IFERROR(CONCATENATE(INDEX(AK7:AK10,SMALL(IF(ISNUMBER(AH7:AH10)*(AH7:AH10>0)*(AK7:AK10<>""),ROW(A1:A4)),ROW()-12)),",",TEXT(INDEX(AH7:AH10,SMALL(IF(ISNUMBER(AH7:AH10)*(AH7:AH10>0)*(AK7:AK10<>""),ROW(A1:A4)),ROW()-12)),"##0"),",",SUBSTITUTE(SUBSTITUTE(INDEX(IF(PURCH_DESC<>"",PURCH_DESC&":","")&A7:A10,SMALL(IF(ISNUMBER(AH7:AH10)*(AH7:AH10>0)*(AK7:AK10<>""),ROW(A1:A4)),ROW()-12)),",",";"),"\n",";"),",",),"")
 Col: AM1
   0
  Formula: IFERROR(CONCATENATE(INDEX(AP7:AP10,SMALL(IF(ISNUMBER(AM7:AM10)*(AM7:AM10>0)*(AP7:AP10<>""),ROW(A1:A4)),ROW()-12)),",",TEXT(INDEX(AM7:AM10,SMALL(IF(ISNUMBER(AM7:AM10)*(AM7:AM10>0)*(AP7:AP10<>""),ROW(A1:A4)),ROW()-12)),"##0"),",",,",",,",",,",",INDEX(D7:D10,SMALL(IF(ISNUMBER(AM7:AM10)*(AM7:AM10>0)*(AP7:AP10<>""),ROW(A1:A4)),ROW()-12)),",",SUBSTITUTE(INDEX(IF(PURCH_DESC<>"",PURCH_DESC&":","")&A7:A10,SMALL(IF(ISNUMBER(AM7:AM10)*(AM7:AM10>0)*(AP7:AP10<>""),ROW(A1:A4)),ROW()-12)),",",";")),"")
 Col: AR1
   0
  Formula: IFERROR(CONCATENATE(INDEX(AU7:AU10,SMALL(IF(ISNUMBER(AR7:AR10)*(AR7:AR10>0)*(AU7:AU10<>""),ROW(A1:A4)),ROW()-12))," ",TEXT(INDEX(AR7:AR10,SMALL(IF(ISNUMBER(AR7:AR10)*(AR7:AR10>0)*(AU7:AU10<>""),ROW(A1:A4)),ROW()-12)),"##0")," ",SUBSTITUTE(INDEX(IF(PURCH_DESC<>"",PURCH_DESC&":","")&A7:A10,SMALL(IF(ISNUMBER(AR7:AR10)*(AR7:AR10>0)*(AU7:AU10<>""),ROW(A1:A4)),ROW()-12))," ",";")),"")
Row: 16
 Col: A1
   "*FILTERED*"
 Col: I1
   0
  Formula: IFERROR(CONCATENATE(INDEX(L7:L10,SMALL(IF(ISNUMBER(I7:I10)*(I7:I10>0)*(L7:L10<>""),ROW(A1:A4)),ROW()-12)),",",TEXT(INDEX(I7:I10,SMALL(IF(ISNUMBER(I7:I10)*(I7:I10>0)*(L7:L10<>""),ROW(A1:A4)),ROW()-12)),"##0"),",",SUBSTITUTE(INDEX(IF(PURCH_DESC<>"",PURCH_DESC&":","")&A7:A10,SMALL(IF(ISNUMBER(I7:I10)*(I7:I10>0)*(L7:L10<>""),ROW(A1:A4)),ROW()-12)),",",";")),"")
 Col: N1
   0
  Formula: IFERROR(CONCATENATE(TEXT(INDEX(N7:N10,SMALL(IF(ISNUMBER(N7:N10)*(N7:N10>0)*(Q7:Q10<>""),ROW(A1:A4)),ROW()-12)),"##0"),",",INDEX(Q7:Q10,SMALL(IF(ISNUMBER(N7:N10)*(N7:N10>0)*(Q7:Q10<>""),ROW(A1:A4)),ROW()-12)),",",SUBSTITUTE(INDEX(IF(PURCH_DESC<>"",PURCH_DESC&":","")&A7:A10,SMALL(IF(ISNUMBER(N7:N10)*(N7:N10>0)*(Q7:Q10<>""),ROW(A1:A4)),ROW()-12)),",",";")),"")
 Col: S1
   0
  Formula: IFERROR(CONCATENATE(INDEX(V7:V10,SMALL(IF(ISNUMBER(S7:S10)*(S7:S10>0)*(V7:V10<>""),ROW(A1:A4)),ROW()-12)),",",TEXT(INDEX(S7:S10,SMALL(IF(ISNUMBER(S7:S10)*(S7:S10>0)*(V7:V10<>""),ROW(A1:A4)),ROW()-12)),"##0"),",",,",",LEFT(SUBSTITUTE(SUBSTITUTE(INDEX(IF(PURCH_DESC<>"",PURCH_DESC&":","")&A7:A10,SMALL(IF(ISNUMBER(S7:S10)*(S7:S10>0)*(V7:V10<>""),ROW(A1:A4)),ROW()-12)),",",";"),"\n",";"),30)),"")
 Col: X1
   0
  Formula: IFERROR(CONCATENATE(TEXT(INDEX(X7:X10,SMALL(IF(ISNUMBER(X7:X10)*(X7:X10>0)*(AA7:AA10<>""),ROW(A1:A4)),ROW()-13)),"##0"),",",SUBSTITUTE(INDEX(IF(PURCH_DESC<>"",PURCH_DESC&":","")&A7:A10,SMALL(IF(ISNUMBER(X7:X10)*(X7:X10>0)*(AA7:AA10<>""),ROW(A1:A4)),ROW()-13)),",",";"),",",SUBSTITUTE(INDEX(IF(PURCH_DESC<>"",PURCH_DESC&":","")&C7:C10,SMALL(IF(ISNUMBER(X7:X10)*(X7:X10>0)*(AA7:AA10<>""),ROW(A1:A4)),ROW()-13)),",",";"),",",INDEX(AA7:AA10,SMALL(IF(ISNUMBER(X7:X10)*(X7:X10>0)*(AA7:AA10<>""),ROW(A1:A4)),ROW()-13))),"")
 Col: AC1
   0
  Formula: IFERROR(CONCATENATE(INDEX(AF7:AF10,SMALL(IF(ISNUMBER(AC7:AC10)*(AC7:AC10>0)*(AF7:AF10<>""),ROW(A1:A4)),ROW()-12)),"|",TEXT(INDEX(AC7:AC10,SMALL(IF(ISNUMBER(AC7:AC10)*(AC7:AC10>0)*(AF7:AF10<>""),ROW(A1:A4)),ROW()-12)),"##0"),"|",SUBSTITUTE(SUBSTITUTE(INDEX(IF(PURCH_DESC<>"",PURCH_DESC&":","")&A7:A10,SMALL(IF(ISNUMBER(AC7:AC10)*(AC7:AC10>0)*(AF7:AF10<>""),ROW(A1:A4)),ROW()-12)),"|",";")," ","_")),"")
 Col: AH1
   0
  Formula: IFERROR(CONCATENATE(INDEX(AK7:AK10,SMALL(IF(ISNUMBER(AH7:AH10)*(AH7:AH10>0)*(AK7:AK10<>""),ROW(A1:A4)),ROW()-12)),",",TEXT(INDEX(AH7:AH10,SMALL(IF(ISNUMBER(AH7:AH10)*(AH7:AH10>0)*(AK7:AK10<>""),ROW(A1:A4)),ROW()-12)),"##0"),",",SUBSTITUTE(SUBSTITUTE(INDEX(IF(PURCH_DESC<>"",PURCH_DESC&":","")&A7:A10,SMALL(IF(ISNUMBER(AH7:AH10)*(AH7:AH10>0)*(AK7:AK10<>""),ROW(A1:A4)),ROW()-12)),",",";"),"\n",";"),",",),"")
 Col: AM1
   0
  Formula: IFERROR(CONCATENATE(INDEX(AP7:AP10,SMALL(IF(ISNUMBER(AM7:AM10)*(AM7:AM10>0)*(AP7:AP10<>""),ROW(A1:A4)),ROW()-12)),",",TEXT(INDEX(AM7:AM10,SMALL(IF(ISNUMBER(AM7:AM10)*(AM7:AM10>0)*(AP7:AP10<>""),ROW(A1:A4)),ROW()-12)),"##0"),",",,",",,",",,",",INDEX(D7:D10,SMALL(IF(ISNUMBER(AM7:AM10)*(AM7:AM10>0)*(AP7:AP10<>""),ROW(A1:A4)),ROW()-12)),",",SUBSTITUTE(INDEX(IF(PURCH_DESC<>"",PURCH_DESC&":","")&A7:A10,SMALL(IF(ISNUMBER(AM7:AM10)*(AM7:AM10>0)*(AP7:AP10<>""),ROW(A1:A4)),ROW()-12)),",",";")),"")
 Col: AR1
   0
  Formula: IFERROR(CONCATENATE(INDEX(AU7:AU10,SMALL(IF(ISNUMBER(AR7:AR10)*(AR7:AR10>0)*(AU7:AU10<>""),ROW(A1:A4)),ROW()-12))," ",TEXT(INDEX(AR7:AR10,SMALL(IF(ISNUMBER(AR7:AR10)*(AR7:AR10>0)*(AU7:AU10<>""),ROW(A1:A4)),ROW()-12)),"##0")," ",SUBSTITUTE(INDEX(IF(PURCH_DESC<>"",PURCH_DESC&":","")&A7:A10,SMALL(IF(ISNUMBER(AR7:AR10)*(AR7:AR10>0)*(AU7:AU10<>""),ROW(A1:A4)),ROW()-12))," ",";")),"")
Row: 17
 Col: X1
   0
  Formula: IFERROR(CONCATENATE(TEXT(INDEX(X7:X10,SMALL(IF(ISNUMBER(X7:X10)*(X7:X10>0)*(AA7:AA10<>""),ROW(A1:A4)),ROW()-13)),"##0"),",",SUBSTITUTE(INDEX(IF(PURCH_DESC<>"",PURCH_DESC&":","")&A7:A10,SMALL(IF(ISNUMBER(X7:X10)*(X7:X10>0)*(AA7:AA10<>""),ROW(A1:A4)),ROW()-13)),",",";"),",",SUBSTITUTE(INDEX(IF(PURCH_DESC<>"",PURCH_DESC&":","")&C7:C10,SMALL(IF(ISNUMBER(X7:X10)*(X7:X10>0)*(AA7:AA10<>""),ROW(A1:A4)),ROW()-13)),",",";"),",",INDEX(AA7:AA10,SMALL(IF(ISNUMBER(X7:X10)*(X7:X10>0)*(AA7:AA10<>""),ROW(A1:A4)),ROW()-13))),"")
